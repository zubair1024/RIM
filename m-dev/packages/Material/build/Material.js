Ext.define("Material.components.field.Field",{override:"Ext.field.Field"});Ext.define("Material.components.MessageBox",{override:"Ext.MessageBox",statics:{OK:{text:"OK",itemId:"ok",ui:"action",cls:"md-flat"},YES:{text:"Yes",itemId:"yes",ui:"action",cls:"md-flat"},NO:{text:"No",itemId:"no",cls:"md-flat"},CANCEL:{text:"Cancel",itemId:"cancel",cls:"md-flat"},OKCANCEL:[{text:"Cancel",itemId:"cancel",cls:"md-flat"},{text:"OK",itemId:"ok",ui:"action",cls:"md-flat"}],YESNOCANCEL:[{text:"Cancel",itemId:"cancel",cls:"md-flat"},{text:"No",itemId:"no",cls:"md-flat"},{text:"Yes",itemId:"yes",ui:"action",cls:"md-flat"}],YESNO:[{text:"No",itemId:"no",cls:"md-flat"},{text:"Yes",itemId:"yes",ui:"action",cls:"md-flat"}]},updateButtons:function(a){var d=this;a=(!a||a.length===0)?false:a;if(a){if(d.buttonsToolbar){d.buttonsToolbar.show();d.buttonsToolbar.removeAll();d.buttonsToolbar.setItems(a)}else{var c={type:"hbox",pack:"right",align:"center"};var b=Ext.theme.name=="CupertinoClassic"||Ext.theme.name=="MountainView"||Ext.theme.name=="Blackberry";d.buttonsToolbar=Ext.create("Ext.Toolbar",{docked:"bottom",defaultType:"button",defaults:{flex:(b)?1:undefined,ui:(Ext.theme.name=="Blackberry")?"action":undefined},layout:c,ui:d.getUi(),cls:d.getBaseCls()+"-buttons",items:a});d.add(d.buttonsToolbar)}}else{if(d.buttonsToolbar){d.buttonsToolbar.hide()}}}});(function(){var b=setTimeout;Ext.define("Material.helpers.RippleService",{attachButtonBehavior:function e(h,g,f){return this.attach(h,g,Ext.merge({},{isFAB:g.hasCls("md-fab"),isMenuItem:g.hasCls("md-menu-item"),center:false,dimBackground:false},f))},attachCheckboxBehavior:function c(h,g,f){return this.attach(h,g,Ext.merge({},{center:true,dimBackground:false},f))},attachTabBehavior:function d(h,g,f){return this.attach(h,g,Ext.merge({},{center:false,dimBackground:true,outline:true},f))},attach:function a(t,j,v){var r=t.getInitialConfig();if((r.noInk||v.noInk)===true){return Ext.emptyFn}v=Ext.merge({},{colorElement:j.dom,mousedown:true,hover:true,focus:true,center:false,mousedownPauseTime:150,dimBackground:false,outline:false,isFAB:false,isMenuItem:false},v);var n,m,f=0,k=[],s=[],q=false,l=false,g=j.dom,i=u(r.inkColor||v.inkColor)||u(window.getComputedStyle(v.colorElement).color||"rgb(0, 0, 0)");j.on({scope:t,touchstart:function(w){if(t.getDisabled()){return false}h(w.pageX,w.pageY);l=true},touchend:function(x){l=false;var w=k.length-1;ripple=k[w];o(ripple)},destroy:function(){n&&n.destroy();n=null}});function u(w){if(!w){return}if(w.indexOf("rgba")===0){return w.replace(/\d?\.?\d*\s*\)\s*$/,"0.1)")}if(w.indexOf("rgb")===0){return x(w)}if(w.indexOf("#")===0){return y(w)}function y(A){var D=A.charAt(0)==="#"?A.substr(1):A,C=D.length/3,E=D.substr(0,C),z=D.substr(C,C),B=D.substr(C*2);if(C===1){E+=E;z+=z;B+=B}return"rgba("+parseInt(E,16)+","+parseInt(z,16)+","+parseInt(B,16)+",0.1)"}function x(z){return z.replace(")",", 0.1)").replace("(","a(")}}function p(w,x){k.splice(k.indexOf(w),1);if(k.length===0){n&&n.setStyle({backgroundColor:""})}b(function(){w.dom.remove()},x,false)}function o(y){var w=k.indexOf(y),z=s[w]||{},A=k.length>1?false:q,x=k.length>1?false:l;if(A||z.animating||x){y.addCls("md-ripple-visible")}else{if(y){y.removeCls("md-ripple-visible");if(v.outline){y.setWidth(m+"px");y.setHeight(m+"px");y.setStyle({marginLeft:(m*-1)+"px",marginTop:(m*-1)+"px"})}p(y,v.outline?450:650)}}}function h(A,G){i=u(j.getAttribute("mdInkRipple"))||u(window.getComputedStyle(v.colorElement).color||"rgb(0, 0, 0)");var z=D(),H=w(A,G),E=x(H,A,G),B=C(E),F=k.indexOf(B),y=s[F]||{};m=H;y.animating=true;b(function(){if(v.dimBackground){z.setStyle({backgroundColor:i})}B.addCls("md-ripple-placed md-ripple-scaled");if(v.outline){B.setStyle({borderWidth:(H*0.5)+"px",marginLeft:(H*-0.5)+"px",marginTop:(H*-0.5)+"px"})}else{B.setStyle({left:"50%",top:"50%"})}o(B);b(function(){y.animating=false;o(B)},(v.outline?450:225),false)},0,false);return B;function C(I){var J=new Ext.Element(document.createElement("div"));J.addCls("md-ripple");J.set({dataCounter:f++});k.unshift(J);s.unshift({animating:true});z.dom.appendChild(J.dom);I&&J.setStyle(I);return J}function w(N,M){var K=z.getWidth(),I=z.getHeight(),O,J,L;if(v.isMenuItem){J=Math.sqrt(Math.pow(K,2)+Math.pow(I,2));console.log("menu-item",J)}else{if(v.outline){L=g.getBoundingClientRect();N-=L.left;M-=L.top;K=Math.max(N,K-N);I=Math.max(M,I-M);J=2*Math.sqrt(Math.pow(K,2)+Math.pow(I,2))}else{O=v.isFAB?1.1:0.8;J=Math.max(K,I)*O}}return J}function x(J,N,M){var L,I={backgroundColor:K(i),borderColor:K(i),width:J+"px",height:J+"px"};if(v.outline){I.width=0;I.height=0}else{I.marginLeft=I.marginTop=(J*-0.5)+"px"}if(v.center){I.left=I.top="50%"}else{L=g.getBoundingClientRect();I.left=Math.round((N-L.left)/z.getWidth()*100)+"%";I.top=Math.round((M-L.top)/z.getHeight()*100)+"%"}return I;function K(O){return O.replace("rgba","rgb").replace(/,[^\)\,]+\)/,")")}}function D(){if(n){return n}var I=n=new Ext.Element(document.createElement("div"));I.addCls("md-ripple-container");j.dom.appendChild(I.dom);return I}}}},function(f){Material.RippleService=new f()})}());Ext.define("Material.components.List",{override:"Ext.dataview.List",requires:["Material.helpers.RippleService"],rippleService:null,initialize:function(){this.callParent();if(this.getCls()=="forList"){this.element.addCls("forList")}else{if(this.getCls()=="forColorPicker"){this.element.addCls("forColorPicker")}}},createItem:function(a){var b=this.callParent([a]),c=this.getInitialConfig();Material.RippleService.attachButtonBehavior(this,b.element,{isMenuItem:true});return b},updateListItem:function(b,a,d){this.callParent([b,a,d]);var c=b.element.down(".md-checkbox .md-container");if(c){this.rippleService.attachCheckboxBehavior(this,c)}}});Ext.define("Material.components.field.SelectPanel",{extend:"Ext.Panel",requires:["Material.helpers.RippleService"],config:{onHide:null},xtype:"select-panel",hide:function(){this.element.addCls("x-hiding");var a=this;setTimeout(function(){a.superclass.hide.call(a);var b=a.getOnHide();if(typeof b==="function"){b.call(a)}a.element.removeCls("x-top x-right x-left x-bottom x-hiding")},201)},showBy:function(){this.callParent(arguments);this.getModal().addCls("x-mask-select-panel")},alignTo:function(i,g){var c=this.getAlignmentInfo(i,g);if(c.isAligned){return}var d=c.stats.alignToBox,k=this.getParent().element.getPageBox(),l=c.stats.height,a=Math.max(d.width,this.getWidth()||0),n=d.bottom-k.top-24,b=k.bottom-d.top+24,f=k.right-d.left-16,h=d.right-k.left+16,e,j,m=this;setTimeout(function(){if(n>=l||n>=b){e=Math.min(l,n);m.setTop(d.bottom-e-2);m.setHeight(e);m.element.addCls("x-bottom")}else{e=Math.min(l,b);m.setTop(d.top);m.setHeight(e);m.element.addCls("x-top")}if(f>=a||f>=h){j=Math.min(a,f);m.setLeft(d.left);m.setWidth(j);m.element.addCls("x-left")}else{j=Math.min(a,h);m.setLeft(d.right-j);m.setWidth(j);m.element.addCls("x-right")}m.setCurrentAlignmentInfo(c)},10)}});Ext.define("Material.components.field.Select",{override:"Ext.field.Select",requires:["Material.components.field.SelectPanel"],getTabletPicker:function(){var b=this.getDefaultTabletPickerConfig(),a=this;if(!this.listPanel){this.listPanel=Ext.create("Material.components.field.SelectPanel",Ext.apply({left:0,top:0,modal:true,cls:Ext.baseCSSPrefix+"select-overlay",layout:"fit",hideOnMaskTap:true,height:(Ext.os.is.BlackBerry&&Ext.os.version.getMajor()===10)?"12em":(Ext.os.is.Phone?"12.5em":"22em"),items:{xtype:"list",cls:"forList",isMenu:true,store:this.getStore(),itemTpl:'<span class="x-list-label">{'+this.getDisplayField()+":htmlEncode}</span>",listeners:{select:this.onListSelect,itemtap:this.onListTap,scope:this}},onHide:function(){a.element.removeCls("x-field-focused")}},b))}return this.listPanel},onFocus:function(){this.element.addCls("x-field-focused");this.callParent(arguments)}});Ext.define("Material.components.Tab",{override:"Ext.tab.Tab",requires:["Material.helpers.RippleService"],initialize:function(){this.callParent();var a=Material.RippleService;a.attachTabBehavior(this,this.element,{inkColor:"#ffff85"});this.element.addCls("md-tab");return this}});Ext.define("Material.components.Button",{extend:"Ext.Button",xtype:"buttonM",config:{},requires:["Material.helpers.RippleService"],initialize:function(){this.callParent();var a=Material.RippleService;a.attachButtonBehavior(this,this.element);this.element.addCls("md-button");return this},applyCategory:function(b){var a=this.element;a.removeCls(["md-flat","md-fab","md-raised"]);switch(b){case"flat":a.addCls("md-flat");break;case"fab":a.addCls("md-fab");break;default:a.addCls("md-raised");break}return b}});Ext.define("Material.components.Checkbox",{extend:"Ext.Component",xtype:"md-checkbox",template:[{tag:"div",reference:"containerElement",className:"md-container",children:[{tag:"div",reference:"containerElement1",className:"md-container1",children:[{tag:"div",reference:"icon",className:"md-icon"},{tag:"div",reference:"icon2",className:"md-icon2"},{tag:"div",reference:"clip",className:"md-icon2"}]}]}],config:{baseCls:"md-checkbox",valueChecked:true,valueUnchecked:false,value:false,checkedCls:"md-checked",radioCls:"md-checkbox-radio",nonradioCls:"md-checkbox-nonradius",clipCls:"md-checkbox-clip",type:"abc"},initialize:function(){this.callParent();if(this.getType()=="radio"){this.element.removeCls(this.getBaseCls());this.element.addCls(this.getRadioCls())}else{if(this.getType()=="nonradius"){this.element.removeCls(this.getBaseCls());this.element.removeCls(this.getRadioCls());this.element.addCls(this.getNonradioCls())}else{if(this.getType()=="clip"){this.element.removeCls(this.getBaseCls());this.element.removeCls(this.getRadioCls());this.element.removeCls(this.getNonradioCls());this.element.addCls(this.getClipCls())}}}this.element.on({scope:this,tap:"onTap"});this.doTap(true);var a=Material.RippleService;a.attachCheckboxBehavior(this,this.containerElement)},onTap:function listener(a){if(this.getDisabled()){return}this.doTap(false)},doTap:function(a){var d=undefined,f=undefined,e=this.getValue(),c=this.getValueChecked(),b=this.getValueUnchecked();if(e==c){d=true;f=b}else{if(e==b){check=false;f=c}}if(!a){d=!d;this.setValue(f)}this.render(d)},render:function render(d){var c=this.clip.dom;if(d){this.element.addCls(this.getCheckedCls());this.icon2.dom.style.zIndex="9";c.style.borderColor="transparent";var b=0;c.style.height=25+"px";c.style.top=5+"px";var a=window.setInterval(function(){c.style.marginLeft=b+"px";b++;if(b>=35){clearInterval(a)}},10)}else{this.element.removeCls(this.getCheckedCls());c.style.marginLeft="0px"}}});Ext.define("Material.components.Slider",{extend:"Ext.Component",xtype:"md-slider",template:[{tag:"div",reference:"trackContainerElement",className:"md-track-container",children:[{tag:"div",reference:"mdTrachElement",className:"md-track"},{tag:"div",reference:"mdTrachElementLeft",className:"track-left"},{tag:"div",reference:"trackFillElement",className:"md-track md-track-fill"},{tag:"div",reference:"trackFillElementLeft",className:"left"},{tag:"div",reference:"trackTicksElement",className:"md-track-ticks"}]},{tag:"div",reference:"thumbContainerElement",id:"thumbContainerElementID",className:"md-thumb-container",children:[{tag:"div",reference:"thumbElement",className:"md-thumb"},{tag:"div",className:"md-focus-thumb"},{tag:"div",className:"md-focus-ring"},{tag:"div",className:"md-sign"},{tag:"div",className:"md-disabled-thumb"}]},{tag:"div",id:"thumbContainerElementLeftID",reference:"thumbContainerElementLeft",className:".md-thumb-containerLeft",children:[{tag:"div",reference:"thumbElementLeft",className:"md-thumbL"},{tag:"div",className:"md-focus-thumb"},{tag:"div",className:"md-focus-ring"},{tag:"div",className:"md-sign"},{tag:"div",className:"md-disabled-thumb"}]}],config:{baseCls:"md-slider",min:0,max:100,step:20,width:0,value:0,valueLeft:0,typeTick:"notradius",type:"tick",tick:"show",sliderLeftCls:"md-slider-left",codeColor:""},updateAll:function(){this.refreshSliderDimensions();this.renderLeft();this.render();this.redrawTicks()},updateMin:function(){this.updateAll()},applyMin:function(a){return parseFloat(a)},updateMax:function(){this.updateAll()},applyMax:function(a){return parseFloat(a)},updateStep:function(){this.redrawTicks()},applyStep:function(a){return parseFloat(a)},redrawTicks:function(){if(this.getType()==="notick"||this.getType()==="notickSingleRight"||this.getType()==="notickSingleLeft"){return}var c=this.getMin(),h=this.getMax(),b=this.getStep(),k=Math.floor((h-c)/b);if(!this.tickCanvas){this.tickCanvas=document.createElement("DIV");this.tickCanvas.style.position="absolute";if(this.getTick()==="hidden"){this.tickCanvas.style.display="none"}this.tickCanvas.style.width=this.getWidth();var a;for(var f=0;f<=k;f++){a=((this.getWidth()/k)*f)/(1);var l=document.createElement("Span");l.style.position="absolute";l.style.width="2px";l.style.height="6px";if(this.getTypeTick()=="radius"){l.style.width="6px";l.style.height="6px";l.style.borderRadius="50%"}l.style.background="#b1ac9c";l.style.marginLeft=a+"px";l.style.marginTop="-4px";this.tickCanvas.appendChild(l)}this.trackTicksElement.appendChild(this.tickCanvas)}if(!this.tickCanvasText){this.tickCanvasText=document.createElement("DIV");this.tickCanvasText.style.marginTop="-47px";this.tickCanvasText.style.width=this.getWidth();for(var d=0;d<=k;d++){if(this.getType()=="tickSingleRight"){a=((this.getWidth()/k)*(k-d))/(1);var l=document.createElement("Span");l.style.position="absolute";l.style.color="white";l.style.background="transparent";l.style.width="30px";l.style.height="30px";l.style.opacity="0";l.style.webkitTransitionDuration="0.3s";l.style.MozTransitionDuration="0.4s";l.style.marginLeft=a-15+"px";var g=document.createElement("Span");g.style.position="absolute";g.style.fontSize=" 15px ";g.style.color="white";g.style.display="inline-block";g.style.width="30px";g.style.height="30px";g.style.zIndex=3;g.style.borderRadius="50%";g.style.background="transparent";g.style.textAlign="center";g.style.paddingTop="6px";g.style.fontSize="12px";var m=document.createTextNode(d*b);g.appendChild(m);l.appendChild(g);var e=document.createElement("Span");e.style.position="absolute";e.style.display="inline-block";e.style.transform="rotate(135deg)";e.style.webkitTransform="rotate(135deg)";e.style.background="#66BB6c";e.style.webkitTransitionDuration="0.3s";e.style.MozTransitionDuration="0.4s";e.style.margin="auto";e.style.left="0px";e.style.right="0px";e.style.bottom="0px";e.style.width="0px";e.style.height="0px";e.style.zIndex=2;e.style.borderTopLeftRadius="50%";e.style.borderBottomLeftRadius="50%";e.style.borderBottomRightRadius="50%";l.appendChild(e);this.tickCanvasText.appendChild(l)}else{a=(Math.floor(this.getWidth()*(d/k)))/(1);var l=document.createElement("Span");l.style.position="absolute";l.style.color="white";l.style.background="transparent";l.style.width="30px";l.style.height="30px";l.style.opacity="0";l.style.webkitTransitionDuration="0.3s";l.style.MozTransitionDuration="0.4s";l.style.marginLeft=a-15+"px";var g=document.createElement("Span");g.style.position="absolute";g.style.fontSize=" 15px ";g.style.color="white";g.style.display="inline-block";g.style.width="30px";g.style.height="30px";g.style.zIndex=3;g.style.borderRadius="50%";g.style.background="transparent";g.style.textAlign="center";g.style.paddingTop="6px";g.style.fontSize="12px";var m=document.createTextNode(d*b);g.appendChild(m);l.appendChild(g);var e=document.createElement("Span");e.style.position="absolute";e.style.display="inline-block";e.style.transform="rotate(135deg)";e.style.webkitTransform="rotate(135deg)";e.style.background="#66BB6c";e.style.webkitTransitionDuration="0.3s";e.style.MozTransitionDuration="0.4s";e.style.margin="auto";e.style.left="0px";e.style.right="0px";e.style.bottom="0px";e.style.width="0px";e.style.height="0px";e.style.zIndex=2;e.style.borderTopLeftRadius="50%";e.style.borderBottomLeftRadius="50%";e.style.borderBottomRightRadius="50%";l.appendChild(e);this.tickCanvasText.appendChild(l)}}this.trackContainerElement.appendChild(this.tickCanvasText)}},refreshSliderDimensions:function(){this.sliderDimensions=this.trackContainerElement.dom.getBoundingClientRect()},getSliderDimensions:function(){return this.sliderDimensions},setModelValue:function(a){this.setValue(this.minMaxValidator(this.stepValidator(a)))},setModelValueLeft:function(a){this.setValueLeft(this.minMaxValidator(this.stepValidator(a)))},updateValue:function(b,a){this.render();this.fireEvent("change",this,this.thumbElement,b,a)},updateValueLeft:function(b,a){this.renderLeft();this.fireEvent("change",this,this.thumbElementLeft,b,a)},render:function(){var b=this.getMin(),a=this.getMax(),d=this.getValue(),c=(d-b)/(a-b);this.setSliderPercent(c)},renderLeft:function(){var b=this.getMin(),a=this.getMax(),d=this.getValueLeft(),c=(d-b)/(a-b);this.setSliderPercentLeft(c)},minMaxValidator:function(c){if(typeof c==="number"&&!isNaN(c)){var b=this.getMin(),a=this.getMax();return Math.max(b,Math.min(a,c))}},stepValidator:function(b){if(typeof b==="number"&&!isNaN(b)){var a=this.getStep();return Math.round(b/a)*a}},setSliderPercent:function(a){this.trackFillElement.setWidth((a*100)+"%");this.draggable&&this.draggable.getTranslatable().translate((-1)*(this.getSliderDimensions().width)*a,0)},setSliderPercentLeft:function(a){this.trackFillElementLeft.setWidth((a*100)+"%");this.draggable&&this.draggable.getTranslatable().translate((+1)*(this.getSliderDimensions().width)*a,0)},initialize:function(){this.callParent();this.element.addCls("md-slider");if(this.getType()=="tickSingleLeft"||this.getType()=="notickSingleLeft"){this.mdTrachElement.setStyle({display:"none"});this.thumbContainerElement.setStyle({display:"none"})}else{if(this.getType()=="tickSingleRight"||this.getType()=="notickSingleRight"){this.mdTrachElement.setStyle({display:"none"});this.thumbContainerElementLeft.setStyle({display:"none"})}else{this.mdTrachElement.setStyle({backgroundColor:"rgb(102,187,106)",zIndex:"-10"});this.mdTrachElementLeft.setStyle({backgroundColor:"rgb(102,187,106)",zIndex:"-10"});this.trackFillElement.setStyle({backgroundColor:"#b1ac9c"});this.trackFillElementLeft.setStyle({backgroundColor:"#b1ac9c"})}}this.element.on({scope:this,touchstart:function(d){if(this.getType()=="tickSingleRight"||this.getType()=="notickSingleRight"){this.draggable=a}else{if(this.getType()=="tickSingleLeft"||this.getType()=="notickSingleLeft"){this.draggable=c}else{if(d.target.className==="md-thumbL"){this.draggable=c}else{if(d.target.className==="md-thumb"){this.draggable=a}}}}if(this.getDisabled()){return false}this.isSliding=true;this.element.addCls("active");this.refreshSliderDimensions();if(this.getType()=="tickSingleRight"||this.getType()=="notickSingleRight"){this.onPan(this.element,d)}else{if(this.getType()=="tickSingleLeft"||this.getType()=="notickSingleLeft"){this.onPanLeft(this.element,d)}else{if(d.target.className==="md-thumbL"){this.onPanLeft(this.element,d)}else{if(d.target.className==="md-thumb"){this.onPan(this.element,d)}}}}d.stopPropagation()},touchend:function(d){if(this.isSliding&&this.element.is(".md-discrete")){if(this.getType()=="tickSingleRight"||this.getType()=="notickSingleRight"){this.onPanEnd(d)}else{if(this.getType()=="tickSingleLeft"||this.getType()=="notickSingleLeft"){this.onPanEndLeft(d)}else{if(d.target.className==="md-thumbL"){this.onPanEndLeft(d)}else{if(d.target.className==="md-thumb"){this.onPanEnd(d)}}}}}this.isSliding=false;this.element.removeCls("panning active")}});var a=Ext.factory({element:this.thumbContainerElement,direction:"horizontal"},Ext.util.Draggable);a.onBefore({dragstart:"onPanStart",drag:"onPan",dragend:"onPanEnd",scope:this});var c=Ext.factory({element:this.thumbContainerElementLeft,direction:"horizontal"},Ext.util.Draggable);c.onBefore({dragstart:"onPanStart",drag:"onPanLeft",dragend:"onPanEndLeft",scope:this});if(this.getType()=="tickSingleRight"||this.getType()=="notickSingleRight"||this.getType()=="tickSingleLeft"||this.getType()=="notickSingleLeft"){if(this.getCodeColor()=="red"){this.element.addCls("md-red");this.thumbElementLeft.setStyle({"background-color":"red"});this.trackFillElementLeft.setStyle({"background-color":"red"})}else{if(this.getCodeColor()=="green"){this.element.addCls("md-green");this.thumbElementLeft.setStyle({"background-color":"green"});this.trackFillElementLeft.setStyle({"background-color":"green"})}else{if(this.getCodeColor()=="blue"){this.element.addCls("md-blue");this.thumbElementLeft.setStyle({"background-color":"blue"});this.trackFillElementLeft.setStyle({"background-color":"blue"})}else{this.thumbElementLeft.setStyle({"background-color":"  rgb(102,187,106)"});this.trackFillElementLeft.setStyle({"background-color":"  rgb(102,187,106)"})}}}}else{this.thumbElementLeft.setStyle({"background-color":" rgb(102,187,106)"});this.trackFillElementLeft.setStyle({"background-color":"#b1ac9c"})}var b=this;b.element.on({resize:"onResize",scope:b});return this},onResize:function(){var a=this;setTimeout(function(){a.refreshSliderDimensions();a.updateAll()})},onPanStart:function(){if(this.getDisabled()){return false}if(!this.isSliding){return}this.element.addCls("panning")},onPan:function(a,b){if(!this.isSliding){return false}this.doSlide(b.pageX);b.stopPropagation&&b.stopPropagation();return false},onPanEnd:function(c){if(this.element.is(".md-discrete")&&!this.getDisabled()){var b=this.percentToValue(this.positionToPercent(c.center.x));var a=this.minMaxValidator(this.stepValidator(b));this.setSliderPercent(this.valueToPercent(a));this.setModelValue(a);c.stopPropagation&&c.stopPropagation();return false}},onPanLeft:function(a,b){if(!this.isSliding){return false}this.doSlideLeft(b.pageX);b.stopPropagation&&b.stopPropagation();return false},onPanEndLeft:function(c){if(this.element.is(".md-discrete")&&!this.getDisabled()){var b=this.percentToValue(this.positionToPercentLeft(c.center.x));var a=this.minMaxValidator(this.stepValidator(b));this.setSliderPercentLeft(this.valueToPercent(a));this.setModelValueLeft(a);c.stopPropagation&&c.stopPropagation();return false}},doSlide:function(h){this.setModelValue(this.percentToValue(this.positionToPercent(h)));var c=this.getMin(),f=this.getMax(),j=this.getValue();var e;e=(j-c)/(f-c);var b=(this.getValueLeft()-c)/(f-c);var a=this.getStep(),g=Math.floor((f-c)/a);if(this.tickCanvasText){for(var d=0;d<=g;d++){if(this.getType()=="tick"){if(d/g===e){console.log(d/g+"============="+e);this.tickCanvasText.childNodes[g-d].style.opacity="1";this.tickCanvasText.childNodes[g-d].childNodes[1].style.width="30px";this.tickCanvasText.childNodes[g-d].childNodes[1].style.height="30px"}else{this.tickCanvasText.childNodes[g-d].childNodes[1].style.width="0px";this.tickCanvasText.childNodes[g-d].childNodes[1].style.height="0px";this.tickCanvasText.childNodes[g-d].style.opacity="0"}}else{if(d/g===e){this.tickCanvasText.childNodes[d].style.opacity="1";this.tickCanvasText.childNodes[d].childNodes[1].style.width="30px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="30px"}else{this.tickCanvasText.childNodes[d].childNodes[1].style.width="0px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="0px";this.tickCanvasText.childNodes[d].style.opacity="0"}}}}if(this.getType()=="tick"){for(var d=0;d<=g;d++){if(d/g===b){this.tickCanvasText.childNodes[d].style.opacity="1";this.tickCanvasText.childNodes[d].childNodes[1].style.width="30px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="30px"}}}},doSlideLeft:function(h){this.setModelValueLeft(this.percentToValue(this.positionToPercentLeft(h)));var c=this.getMin(),f=this.getMax(),j=this.getValueLeft(),e=(j-c)/(f-c),b=(this.getValue()-c)/(f-c),a=this.getStep(),g=Math.floor((f-c)/a);if(this.tickCanvasText){for(var d=0;d<=g;d++){if(this.getType()=="tick"){if(d/g===e||d/g===1-b){this.tickCanvasText.childNodes[d].style.opacity="1";this.tickCanvasText.childNodes[d].childNodes[1].style.width="30px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="30px"}else{this.tickCanvasText.childNodes[d].childNodes[1].style.width="0px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="0px";this.tickCanvasText.childNodes[d].style.opacity="0"}}else{if(d/g===e){this.tickCanvasText.childNodes[d].style.opacity="1";this.tickCanvasText.childNodes[d].childNodes[1].style.width="30px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="30px"}else{this.tickCanvasText.childNodes[d].childNodes[1].style.width="0px";this.tickCanvasText.childNodes[d].childNodes[1].style.height="0px";this.tickCanvasText.childNodes[d].style.opacity="0"}}}}},adjustThumbPosition:function(b){var c=this.percentToValue(this.positionToPercent(b));var a=this.minMaxValidator(this.stepValidator(c));this.setSliderPercent(this.positionToPercent(b))},positionToPercent:function(a){return Math.max(0,Math.min(1,(this.sliderDimensions.right-a)/(this.sliderDimensions.width)))},positionToPercentLeft:function(a){return Math.max(0,Math.min(1,(a-this.sliderDimensions.left)/(this.sliderDimensions.width)))},percentToValue:function(c){var b=this.getMin(),a=this.getMax();return(b+c*(a-b))},valueToPercent:function(c){var b=this.getMin(),a=this.getMax();return(c-b)/(a-b)}});Ext.define("Material.components.ColorPicker",{extend:"Ext.Panel",xtype:"md-ColorPicker",alias:"widget.ColorPicker",requires:["Material.components.Slider"],config:{oldV:"#000000",newV:"#000000",itemIndex:"",modal:true,hideOnMaskTap:true,centered:true,showAnimation:{type:"popIn",duration:250,easing:"ease-out"},hideAnimation:{type:"popOut",duration:250,easing:"ease-out"},items:[{xtype:"container",layout:"vbox",width:"380px",itemId:"parent1",items:[{xtype:"container",itemId:"parent2",width:"100%",layout:"hbox",items:[{xtype:"container",layout:"vbox",itemId:"parent3",width:"70%",padding:10,items:[{xtype:"container",itemId:"tpl",style:"background:rgb(0,0,0); marginBottom:25px",width:"100%",height:150,items:{xtype:"textfield",itemId:"code-color",text:"#Color",clearIcon:false,style:"font-size: 100%; background:transparent;margin:auto; width:40%",centered:true}},{xtype:"md-slider",width:"100%",height:60,max:255,itemId:"itemIdR",min:0,step:1,type:"notickSingleLeft",tick:"hidden",codeColor:"red"},{xtype:"md-slider",itemId:"itemIdG",width:"100%",height:60,max:255,min:0,step:1,type:"notickSingleLeft",tick:"hidden",codeColor:"green"},{xtype:"md-slider",itemId:"itemIdB",width:"100%",height:60,max:255,min:0,step:1,type:"notickSingleLeft",tick:"hidden",codeColor:"blue"}]},{xtype:"panel",itemId:"parent33",width:"30%",style:"margin-left:6px;",height:350,items:[{xtype:"list",itemId:"listItemId",itemTpl:'<div style="text-align: center; vertical-align: middle;display: table; font-size: 12px; margin-top: -5px; margin-left: 18px">{value}</div>',cls:"forColorPicker",style:"padding:10px 10px 0px 0px;background:transparent",height:"100%",width:"100%",data:[{title:"Red",value:"#F44336"},{title:"Pink",value:"#E91E63"},{title:"Purple",value:"#9C27B0"},{title:"Deep Purple",value:"#673AB7"},{title:"Indigo",value:"#3F51B5"},{title:"Blue",value:"#2196F3"},{title:"Light Blue",value:"#03A9F4"},{title:"Cyan",value:"#00BCD4"},{title:"Teal",value:"#009688"},{title:"Green",value:"#4CAF50"},{title:"Light Green",value:"#8BC34A"},{title:"Lime",value:"#CDDC39"},{title:"Yellow",value:"#FFEB3B"},{title:"Amber",value:"#FFC107"},{title:"Orange",value:"#FF9800"},{title:"Deep Orange",value:"#FF5722"},{title:"Brown",value:"#795548"},{title:"Grey",value:"#9E9E9E"},{title:"Blue Grey",value:"#607D8B"},{title:"Black",value:"#000000"},{title:"White",value:"#FFFFFF"}]}]}]},{xtype:"container",style:"background:transparent",itemId:"parent22",width:"100%",layout:{type:"hbox",pack:"right",align:"center"},defaults:{type:"button"},items:[{xtype:"button",text:"Cancel",itemId:"btnCancel",cls:"md-button-toolbar"},{xtype:"button",text:"OK",cls:"md-button-toolbar",itemId:"btnOk"}]}]}]},initialize:function(){this.callParent();var k=this;var a=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdR");var f=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdG");var l=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdB");var h=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl");var c=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl").getComponent("code-color");this.getComponent("parent1").getComponent("parent2").getComponent("parent3").setStyle("opacity:0.9");this.setValueColorPicker(this.getNewV());this.getComponent("parent1").getComponent("parent22").getComponent("btnOk").on("tap",function(){var b={oldValue:k.getOldV(),newValue:k.getNewV()};k.fireEvent("onChangedColor",b);k.hidePop()});c.element.on({scope:this,touchstart:function(b){k.setOldV(c.getValue())}});c.on("change",function(){h.setStyle("background:"+c.getValue());k.setNewV(c.getValue());k.chanceValueSlider(c.getValue())});a.element.on({scope:this,touchstart:function(b){k.setOldV(c.getValue())},touchend:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}},touchmove:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}}});f.element.on({scope:this,touchstart:function(b){k.setOldV(c.getValue())},touchend:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}},touchmove:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}}});l.element.on({scope:this,touchstart:function(b){k.setOldV(c.getValue())},touchend:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}},touchmove:function(g){var m=a.getValueLeft();var i=f.getValueLeft();var b=l.getValueLeft();c.setValue(this.rgbToHex(m,i,b).toUpperCase());k.setNewV(this.rgbToHex(m,i,b).toUpperCase());if(m<150&&i<150&&b<150){c.setStyle("-webkit-text-fill-color:white")}else{c.setStyle("-webkit-text-fill-color:black")}}});this.getComponent("parent1").getComponent("parent2").getComponent("parent33").getComponent("listItemId").addListener({itemtap:function(m,g,i,b){k.setColorItemList(b.get("value"));k.setOldV(k.codeColor());k.setCodeColor(b.get("value"));k.setNewV(b.get("value"));k.chanceValueSlider(b.get("value"));k.chanTextColor()}});var j=this.getComponent("parent1").getComponent("parent2").getComponent("parent33").getComponent("listItemId");var e=j.getData();for(var d=0;d<j.getData().length;d++){j.getItemAt(d).setStyle("background:"+e[d].value+";min-height:28px;height:28px")}k.chanTextColor()},componentToHex:function(b){var a=b.toString(16);return a.length==1?"0"+a:a},rgbToHex:function(d,c,a){return"#"+this.componentToHex(d)+this.componentToHex(c)+this.componentToHex(a)},hidePop:function(){this.setStyle({display:"none"});this.hide()},showPop:function(){this.setStyle({display:"block"});this.show()},codeColor:function(){var a=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl").getComponent("code-color");return a.getValue().toUpperCase()},setColorItemList:function(b){var c=this;var a=c.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl");a.setStyle("background:"+b)},setCodeColor:function(b){var a=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl").getComponent("code-color");a.setValue(b.toUpperCase())},chanTextColor:function(){var d=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl").getComponent("code-color");var f=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdR");var i=f.getValueLeft();var e=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdG");var h=e.getValueLeft();var a=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdB");var c=a.getValueLeft();if(i<150&&h<150&&c<150){d.setStyle("-webkit-text-fill-color:white")}else{d.setStyle("-webkit-text-fill-color:black")}},hexToRGB:function(e){if(e.charAt(0)=="#"){e=e.substr(1)}var d,c,a;d=e.charAt(0)+""+e.charAt(1);c=e.charAt(2)+""+e.charAt(3);a=e.charAt(4)+""+e.charAt(5);d=parseInt(d,16);c=parseInt(c,16);a=parseInt(a,16);return"rgb("+d+","+c+","+a+")"},hexToRGBComponent:function(c,f){if(f.charAt(0)=="#"){f=f.substr(1)}var e,d,a;e=f.charAt(0)+""+f.charAt(1);d=f.charAt(2)+""+f.charAt(3);a=f.charAt(4)+""+f.charAt(5);e=parseInt(e,16);d=parseInt(d,16);a=parseInt(a,16);if(e<150&&d<150&&a<150){c.setStyle({color:"white"})}else{c.setStyle({color:"black"})}},chanceValueSlider:function(e){if(e.charAt(0)=="#"){e=e.substr(1)}var d=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdR");d.fireEvent("touchstart",this);d.setValueLeft(parseInt(e.charAt(0)+""+e.charAt(1),16));var c=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdG");c.setValueLeft(parseInt(e.charAt(2)+""+e.charAt(3),16));var a=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdB");a.setValueLeft(parseInt(e.charAt(4)+""+e.charAt(5),16))},setValueColorPicker:function(a){this.chanceValueSlider(a);var c=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl").getComponent("code-color");c.setValue(a.toUpperCase());var b=this.getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("tpl");b.setStyle("background:"+a)}});Ext.define("Material.components.ColorPickerMain",{extend:"Ext.Container",xtype:"md-ColorPickerMain",requires:["Material.components.ColorPicker"],config:{fortype:"down",labelColor:"black",texLabel:"a",items:{xtype:"container",width:"395px",style:"background:transparent",itemId:"root",items:[{xtype:"label",text:"color",color:"black",html:"value",width:100,left:0,itemId:"lb",style:"background:trasparent; position:absolute; line-height:35px; height:35px"},{xtype:"label",text:"color",color:"black",width:100,top:40,left:0,style:"background-color:transparent; position:absolute; vertical-align: middle; textAlign:center; line-height:35px; height:35px",itemId:"btnColor"},{xtype:"md-ColorPicker",itemId:"colorPicker",top:80,left:"-50%",width:"100%"}]}},initialize:function(){this.callParent();var g=this;var j=g.getComponent("root");var f=35;var i=35;var k=500;var e=500;var c=g.getComponent("root").getComponent("colorPicker");var b=g.getComponent("root").getComponent("btnColor");var d=g.getComponent("root").getComponent("lb");d.setHtml(this.getTexLabel());d.setStyle("color:"+this.getLabelColor());this.setCodeColor("#000000");g.chanTextColor();c.hidePop();b.element.on("tap",function(){c.showPop()});if(this.getFortype()=="up"){c.setStyle({top:"-480px"})}var a="#000000";c.getComponent("parent1").getComponent("parent22").getComponent("btnOk").on("tap",function(){b.element.show();a=b.getHtml();b.setHtml(g.getComponent("root").getComponent("colorPicker").codeColor());b.setStyle("background:"+g.getComponent("root").getComponent("colorPicker").codeColor());g.getComponent("root").getComponent("colorPicker").hidePop();g.chanTextColor();var h={oldValue:a,newValue:g.getComponent("root").getComponent("colorPicker").codeColor()};g.fireEvent("onColorChanged",h)});c.getComponent("parent1").getComponent("parent22").getComponent("btnCancel").on("tap",function(){b.element.show();g.getComponent("root").getComponent("colorPicker").hidePop()})},setCodeColor:function(f){var j=this;var e=j.getComponent("root").getComponent("colorPicker");e.setValueColorPicker(f);var d=j.getComponent("root").getComponent("btnColor");d.setHtml(j.getComponent("root").getComponent("colorPicker").codeColor());d.setStyle("background:"+j.getComponent("root").getComponent("colorPicker").codeColor());var a=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdR");var h=a.getValueLeft();var i=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdG");var l=i.getValueLeft();var k=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdB");var c=k.getValueLeft();if(h<150&&l<150&&c<150){d.setStyle("color:white")}else{d.setStyle("color:black")}},getCodeColor:function(){var a=this.getComponent("root").getComponent("btnColor");console.log("getCodeColor: "+a.getHtml());return a.getHtml()},chanTextColor:function(){var c=this.getComponent("root").getComponent("btnColor");var f=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdR");var i=f.getValueLeft();var e=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdG");var h=e.getValueLeft();var a=this.getComponent("root").getComponent("colorPicker").getComponent("parent1").getComponent("parent2").getComponent("parent3").getComponent("itemIdB");var d=a.getValueLeft();if(i<150&&h<150&&d<150){c.setStyle("color:white")}else{c.setStyle("color:black")}}});Ext.define("Material.components.picker.DatePickerSlot",{extend:"Ext.picker.Slot",xtype:"md-date-picker-slot",config:{barHeight:48},setupBar:function(){if(!this.isRendered()){return}var a=this.element,d=this.innerElement,i=this.getValue(),b=this.getShowTitle(),h=this.getTitle(),f=this.getScrollable(),e=f.getScroller(),c=0,j,g;if(b&&h){c=h.element.getHeight()}g=Math.ceil((a.getHeight()-c-this.getBarHeight())/2);if(this.getVerticallyCenterItems()){d.setStyle({padding:g+"px 0 "+g+"px"})}e.refresh();e.setSlotSnapSize(j);this.setValue(i)},onScrollEnd:function(b,a,c){},doItemTap:function(d,a,c,f){var b=this;b.selectedIndex=a;b.selectedNode=c;b.scrollToItem(c.getY?c:c.element,true);this.fireEvent("slotpick",this,this.getValue(true),this.selectedNode)},doSetValue:function(d,b){if(!this.isRendered()){this._value=d;return}var e=this.getStore(),i=this.getViewItems(),g=this.getValueField(),a=Material.DatePickerService,h=this,c,f;c=e.findBy(function(j){var k=j.get(g);return d instanceof Date?a.isEqualMonth(k,d):k===d});if(c==-1){c=0}f=Ext.get(i[c]);h.selectedIndex=c;h.selectedNode=f;if(f){if(this._item_scrolling){clearTimeout(this._item_scrolling)}this._item_scrolling=setTimeout(function(){h.scrollToItem(f.getY?f:f.element,(b)?{duration:100}:false);h.select(h.selectedIndex)},250)}this._value=d}});Ext.define("Material.components.picker.CalendarItem",{extend:"Ext.Component",xtype:"calendar-item",width:"280px",height:"250px",isComposite:true,requires:["Material.helpers.RippleService"],template:[{tag:"div",html:"February 1989",reference:"headerElement",className:"header"},{tag:"div",className:"week-bar",children:[{tag:"span",text:"S"},{tag:"span",text:"M"},{tag:"span",text:"T"},{tag:"span",text:"W"},{tag:"span",text:"T"},{tag:"span",text:"F"},{tag:"span",text:"S"}]},{tag:"div",className:"week",children:[{tag:"button",text:"1"},{tag:"button",text:"2"},{tag:"button",text:"3"},{tag:"button",text:"4"},{tag:"button",text:"5"},{tag:"button",text:"6"},{tag:"button",text:"7"}]},{tag:"div",className:"week",children:[{tag:"button",text:"8"},{tag:"button",text:"9"},{tag:"button",text:"10"},{tag:"button",text:"11"},{tag:"button",text:"12"},{tag:"button",text:"13"},{tag:"button",text:"14"}]},{tag:"div",className:"week",children:[{tag:"button",text:"15"},{tag:"button",text:"16"},{tag:"button",text:"17"},{tag:"button",text:"18"},{tag:"button",text:"19"},{tag:"button",text:"20"},{tag:"button",text:"21"}]},{tag:"div",className:"week",children:[{tag:"button",text:"22"},{tag:"button",text:"23"},{tag:"button",text:"24"},{tag:"button",text:"25"},{tag:"button",text:"26"},{tag:"button",text:"27"},{tag:"button",text:"28"}]},{tag:"div",className:"week",children:[{tag:"button",text:"29"},{tag:"button",text:"30"},{tag:"button",text:"31"},{tag:"button",text:"32"},{tag:"button",text:"33"},{tag:"button",text:"34"},{tag:"button",text:"35"}]},{tag:"div",className:"week",children:[{tag:"button",text:"36"},{tag:"button",text:"37"},{tag:"button",text:"38"},{tag:"button",text:"39"},{tag:"button",text:"40"},{tag:"button",text:"41"},{tag:"button",text:"42"}]}],config:{baseCls:"md-calendar-item",dataview:null,record:null,width:"100%"},initialize:function(){this.callParent(arguments)},updateRecord:function(b){if(!b){return}this._record=b;var c=this,a=c.dataview||this.getDataview(),d=a.prepareData(b.getData(true),a.getStore().indexOf(b),b);c.generateWeekGrid(d);c.fireEvent("updatedata",c,d)},generateWeekGrid:function(b){var a=Material.DatePickerService,h=b.value,d=a.getWeekArray(h),g=this.element.query(".week button"),c=this.headerElement,i=new Date(),f=b.selectedDate||i,e=(this.dataview||this.getDataview()).up("md-date-picker");this.element.removeCls("md-4-weeks md-5-weeks md-6-weeks");this.element.addCls("md-"+d.length+"-weeks");c.setHtml(a.getFullMonth(h)+" "+h.getFullYear());Ext.each(d,function(k,j){Ext.each(k,function(l,m){var n=Ext.Element.get(g[m+j*7]);n.removeCls("selected today");n.setHtml("&nbsp;");n.set({"data-date":null},true);if(l instanceof Date){n.setHtml(l.getDate());n.set({"data-date":l},true);if(a.isEqualDate(f,l)){n.addCls("selected");e.lastSelectedDate=n}if(a.isEqualDate(i,l)){n.addCls("today")}}},this)},this)}});Ext.define("Material.helpers.DatePickerService",{addDays:function(b,c){var a=this.clone(b);a.setDate(b.getDate()+c);return a},addMonths:function(c,a){var b=this.clone(c);b.setMonth(c.getMonth()+a);return b},clone:function(a){return new Date(a.getTime())},getDaysInMonth:function(a){var b=this.getFirstDayOfMonth(a);b.setMonth(b.getMonth()+1);b.setDate(b.getDate()-1);return b.getDate()},getFirstDayOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),1,0,0,0)},getFullMonth:function(b){var a=b.getMonth();switch(a){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December"}},getShortMonth:function(b){var a=b.getMonth();switch(a){case 0:return"Jan";case 1:return"Feb";case 2:return"Mar";case 3:return"Apr";case 4:return"May";case 5:return"Jun";case 6:return"Jul";case 7:return"Aug";case 8:return"Sep";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec"}},getDayOfWeek:function(a){var b=a.getDay();switch(b){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday"}},getWeekArray:function(j){var c=[];var b=this.getDaysInMonth(j);var k;var f;var a;var e;var h=[];for(var g=1;g<=b;g++){c.push(new Date(j.getFullYear(),j.getMonth(),g))}while(c.length){a=c[0].getDay();k=7-a;f=7-k;e=c.splice(0,k);for(var g=0;g<f;g++){e.unshift(null)}for(var g=e.length;g<7;g++){e.push(null)}h.push(e)}return h},format:function(b){var a=b.getMonth()+1;var c=b.getDate();var e=b.getFullYear();return a+"/"+c+"/"+e},isEqualDate:function(b,a){return b&&a&&(b.getFullYear()===a.getFullYear())&&(b.getMonth()===a.getMonth())&&(b.getDate()===a.getDate())},isEqualMonth:function(b,a){return b&&a&&(b.getFullYear()===a.getFullYear())&&(b.getMonth()===a.getMonth())},monthDiff:function(c,b){var a;a=(c.getFullYear()-b.getFullYear())*12;a+=c.getMonth();a-=b.getMonth();return a}},function(a){Material.DatePickerService=new a()});Ext.define("Material.components.picker.DateDetailsPanel",{extend:"Ext.Component",xtype:"md-date-details",requires:["Material.helpers.DatePickerService","Material.helpers.RippleService"],template:[{tag:"label",className:"day-of-week",reference:"lblDayOfWeek",html:"Thursday"},{tag:"div",className:"day-of-month",children:[{tag:"button",className:"month",reference:"btnMonth",html:"FEB"},{tag:"button",className:"day",reference:"btnDay",html:"09"},{tag:"button",className:"year",reference:"btnYear",html:"1989"}]}],config:{baseCls:"md-date-details",selectedDate:null},initialize:function(){this.callParent(arguments);this.setSelectedDate(new Date());var a={scope:this,tap:function(){this.toggleHighlight(true);this.fireEvent("show-month",this)}};this.btnDay.on(a);this.btnMonth.on(a);this.btnYear.on({scope:this,tap:function(){this.toggleHighlight(false);this.fireEvent("show-year",this)}})},applySelectedDate:function(a){if(a instanceof Date){return a}return new Date()},updateSelectedDate:function(c,a){var b=Material.DatePickerService;this.updateDisplay(c)},updateDisplay:function(b){if(!this.lblDayOfWeek){return}var a=Material.DatePickerService;this.lblDayOfWeek.setHtml(a.getDayOfWeek(b));this.btnDay.setText(b.getDate());this.btnMonth.setText(a.getShortMonth(b));this.btnYear.setText(b.getFullYear());this.toggleHighlight(true)},toggleHighlight:function(a){var b="highlight";if(a){this.btnDay.addCls(b);this.btnMonth.addCls(b);this.btnYear.removeCls(b)}else{this.btnDay.removeCls(b);this.btnMonth.removeCls(b);this.btnYear.addCls(b)}}});Ext.define("Material.components.DatePicker",{extend:"Ext.Sheet",xtype:"md-date-picker",requires:["Ext.Toolbar","Ext.Button","Ext.Label","Material.components.picker.DatePickerSlot","Material.components.picker.CalendarItem","Material.components.picker.DateDetailsPanel","Material.helpers.DatePickerService"],config:{baseCls:"md-date-picker",cls:"x-msgbox x-msgbox-dark",ui:"dark",layout:{type:"vbox",pack:"justify",align:"stretched"},showAnimation:{type:"popIn",duration:250,easing:"ease-out"},hideAnimation:{type:"popOut",duration:250,easing:"ease-out"},items:[{xtype:"panel",itemId:"main-container",cls:"main-container",layout:{type:"vbox",pack:"justify",align:"stretched"},items:[{xtype:"md-date-details",itemId:"md-date-details"},{xtype:"panel",cls:"main-panel",itemId:"main-panel",layout:{type:"card",animation:"fade"},items:[{xtype:"md-date-picker-slot",cls:"x-picker-slot month-picker",itemId:"month-picker",barHeight:270,useComponents:true,defaultType:"calendar-item",data:[{value:new Date(),selectedDate:new Date()}]},{xtype:"md-date-picker-slot",cls:"x-picker-slot year-picker",itemId:"year-picker",barHeight:72,data:[{value:2015,text:2015}]}]}]},{xtype:"toolbar",docked:"bottom",ui:"dark",itemId:"button-bar",cls:"x-msgbox-buttons",layout:{type:"hbox",pack:"right",align:"center"},defaults:{type:"button"},items:[{text:"Cancel"},{text:"OK",ui:"action"}]}],orientationMode:"portrait",selectedDate:new Date(),yearFrom:new Date().getFullYear()-50,yearTo:new Date().getFullYear()+50},initialize:function(){this.callParent();this.setupEventHandler();this.updateYearPicker();this.prepareMonthPicker();this.showCalendar()},setupEventHandler:function(){this.element.on({scope:this,delegate:".md-calendar-item button",tap:"selectDate"});this.on({scope:this,delegate:"toolbar#button-bar button",tap:"onClick"});this.on({"show-month":"showCalendar",delegate:"md-date-details",scope:this});this.on({"show-year":"showYearList",delegate:"md-date-details",scope:this});this.on({tap:"showYearList",delegate:"panel#selected-date button#year",scope:this});this.on({slotpick:"pickYear",delegate:"md-date-picker-slot#year-picker",scope:this})},getMainPanel:function(){return this._mainPanel||(this._mainPanel=this.getComponent("main-container").getComponent("main-panel"))},getYearPicker:function(){return this._yearPicker||(this._yearPicker=this.getMainPanel().getComponent("year-picker"))},getMonthPicker:function(){return this._monthPicker||(this._monthPicker=this.getMainPanel().getComponent("month-picker"))},updateYearPicker:function(){var a=this.getYearFrom(),c=this.getYearTo(),b=[];while(true){b.push({text:a,value:a});if(c==a){break}a++}this.getYearPicker().getStore().setData(b)},pickYear:function(b,d){var c=Material.DatePickerService,a=c.clone(this.getSelectedDate());a.setYear(d);this.setSelectedDate(a);this.showCalendar()},showCalendar:function(){var a=Material.DatePickerService,b=this.getMainPanel();if(b.calendarShown!==true){b.setActiveItem(0);b.calendarShown=true}this.getMonthPicker().setValue(this.getSelectedDate())},showYearList:function(){var a=this.getMainPanel();var b=this.getYearPicker();if(a.calendarShown!==false){a.setActiveItem(1);a.calendarShown=false}b.setValue(this.getSelectedDate().getFullYear())},onClick:function(a,b){if(a.getUi()=="action"){this._onDone(this.getSelectedDate())}this._onHide();this.hide()},selectDate:function(d,g){var f=this.lastSelectedDate,b=d.target||d.delegatedTarget;if(f!=b){var a=Ext.Element.get(b);var c=Date.parse(a.getAttribute("data-date"));if(isNaN(c)){return}this.setSelectedDate(new Date(c));if(f){Ext.Element.get(f).removeCls("selected")}this.lastSelectedDate=b;a.addCls("selected")}},applySelectedDate:function(a){if(a&&!(a instanceof Date)){a=Date.parse(a)}return a instanceof Date?a:new Date()},updateSelectedDate:function(d,a){if(d instanceof Date){var b=Material.DatePickerService,c=this.getComponent("main-container").getComponent("md-date-details");c.setSelectedDate(d);this.prepareMonthPicker()}},prepareMonthPicker:function(){var e=Material.DatePickerService,c=this.getSelectedDate(),d=c.getFullYear();if(this._currentYear==d){Ext.each(this.query("panel#week-grid button"),function(f){if(e.isEqualDate(f.date,c)){f.element.addCls("selected");this.lastSelectedDate=f}else{f.element.removeCls("selected")}});this.getMonthPicker().setValue(c);return}this._currentYear=d;var a=[];for(var b=0;b<12;b++){a.push({value:new Date(d,b,1,0,0,0),selectedDate:c})}this.getMonthPicker().getStore().setData(a);this.getMonthPicker().setValue(c)},onOrientationChange:function(){var a=this.getComponent("main-container"),b=Ext.Viewport.getOrientation();this.element.removeCls("landscape portrait");if(b=="landscape"){a.getLayout().setOrient("horizontal");this.element.addCls("landscape")}else{a.getLayout().setOrient("vertical");this.element.addCls("portrait")}},show:function(a){if(!a){return}if(!this.getParent()&&Ext.Viewport){Ext.Viewport.add(this);Ext.Viewport.on({orientationchange:this.onOrientationChange,scope:this});this.onOrientationChange()}this._onDone=a.done||Ext.emptyFn;this._onHide=a.hide||Ext.emptyFn;this.showCalendar();this.callParent();return this}},function(a){Ext.onSetup(function(){Material.DatePicker=new a()})});Ext.define("Material.components.Entry",{extend:"Ext.Component",xtype:"md-entry",config:{value:null,label:null}});Ext.define("Material.components.ProgressCircular",{extend:"Ext.Mask",xtype:"md-progress-circular",config:{endless:false,value:0,type:"percent",message:"Loading"},getTemplate:function(){return[{tag:"div",reference:"outerElement",cls:"md-progress-circular",children:[{tag:"div",reference:"wrapperElement",cls:"md-spinner-wrapper",children:[{tag:"div",reference:"innerElement",cls:"md-inner",children:[{tag:"div",reference:"P100",cls:"myrounded",text:"0 %"},{tag:"div",cls:"md-right",children:[{tag:"div",reference:"r",cls:"md-half-circle"}]},{tag:"div",cls:"md-left",children:[{tag:"div",reference:"l",cls:"md-half-circle"}]}]}]}]}]},applyEndless:function(b){var a=this.outerElement.dom;if(b===true){a.setAttribute("md-mode","indeterminate")}else{a.setAttribute("md-mode","determinate")}return b},applyValue:function(a){},initialize:function(){this.callParent();var f=this.outerElement.dom;var d=this.r.dom;var b=this.l.dom;var a=-135;var g=135;var c=true;if(this.getType()==="percent"){localStorage.setItem("dem",0);var e=this.P100;b.style.webkitTransform="rotate("+g+"deg)";b.style.WebkitTransition="-webkit-transform 0.1s  ease-out";d.style.webkitTransform="rotate("+a+"deg)";d.style.WebkitTransition="-webkit-transform 0.1s  ease-out";b.style.MozTransform="rotate("+g+"deg)";b.style.MozTransition="-webkit-transform 0.1s  ease-out";d.style.MozTransform="rotate("+a+"deg)";d.style.MozTransition="-webkit-transform 0.1s  ease-out";b.style.OTransform="rotate("+g+"deg)";b.style.OTransition="-webkit-transform 0.1s  ease-out";d.style.OTransform="rotate("+a+"deg)";d.style.OTransition="-webkit-transform 0.1s  ease-out";this.on("tap",function(){if(c){c=false;localStorage.setItem("dem",0);a=-135;g=135;var h=window.setInterval(function(){if(parseInt(localStorage.getItem("dem"))>=100){clearInterval(h);c=true}if(parseInt(localStorage.getItem("dem"))<=50){b.style.webkitTransform="rotate("+g+"deg)";b.style.WebkitTransition="-webkit-transform 0.1s  ease-out";d.style.webkitTransform="rotate("+a+"deg)";d.style.WebkitTransition="-webkit-transform 0.1s  ease-out";b.style.MozTransform="rotate("+g+"deg)";b.style.MozTransition="-webkit-transform 0.1s  ease-out";d.style.MozTransform="rotate("+a+"deg)";d.style.MozTransition="-webkit-transform 0.1s  ease-out";b.style.OTransform="rotate("+g+"deg)";b.style.OTransition="-webkit-transform 0.1s  ease-out";d.style.OTransform="rotate("+a+"deg)";d.style.OTransition="-webkit-transform 0.1s  ease-out";a=a+3.6}else{a=45;g=g+3.6;b.style.webkitTransform="rotate("+g+"deg)";b.style.WebkitTransition="-webkit-transform 0.1s  ease-out";d.style.webkitTransform="rotate("+a+"deg)";d.style.WebkitTransition="-webkit-transform 0.1s  ease-out";b.style.MozTransform="rotate("+g+"deg)";b.style.MozTransition="-webkit-transform 0.1s  ease-out";d.style.MozTransform="rotate("+a+"deg)";d.style.MozTransition="-webkit-transform 0.1s  ease-out";b.style.OTransform="rotate("+g+"deg)";b.style.OTransition="-webkit-transform 0.1s  ease-out";d.style.OTransform="rotate("+a+"deg)";d.style.OTransition="-webkit-transform 0.1s  ease-out"}e.setText(localStorage.getItem("dem")+"%");localStorage.setItem("dem",parseInt(localStorage.getItem("dem"))+1)},100)}})}else{this.P100.setStyle({display:"none"});f.setAttribute("md-mode","indeterminate")}}});Ext.define("Material.components.Toggle",{extend:"Ext.Component",xtype:"md-toggle",requires:["Ext.util.Draggable"],template:[{tag:"div",reference:"containerElement",className:"md-container",children:[{tag:"div",reference:"barElement",className:"md-bar"},{tag:"div",reference:"thumbContainerElement",className:"md-thumb-container",children:[{tag:"div",reference:"thumbElement",className:"md-thumb"}]}]}],config:{baseCls:"md-switch",valueChecked:true,valueUnchecked:false,value:false,checkedCls:"md-checked",checkedCls1:"md-checked1",checkedCls2:"md-checked2",checkedCls3:"md-checked3",codeColor:""},initialize:function(){this.callParent();this.element.addCls("transition");var a=Ext.factory({element:this.thumbContainerElement,direction:"horizontal"},Ext.util.Draggable);a.onBefore({dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",scope:this});this.element.on({scope:this,tap:"onTap",resize:"onResize"});var b=Material.RippleService;b.attachCheckboxBehavior(this,this.thumbElement)},onResize:function(){var a=this;setTimeout(function(){a.doTap(true)})},onTap:function listener(a){if(this.getDisabled()){return}this.doTap(false)},doTap:function(a){var d=undefined,f=undefined,e=this.getValue(),c=this.getValueChecked(),b=this.getValueUnchecked();if(e==c){d=true;f=b}else{if(e==b){check=false;f=c}}if(!a){d=!d;this.setValue(f);this.fireEvent("change",this,this.thumbElement,f,e)}this.render(d)},render:function render(a){if(a){if(this.getCodeColor()===1){this.element.addCls(this.getCheckedCls1())}else{if(this.getCodeColor()===2){this.element.addCls(this.getCheckedCls2())}else{if(this.getCodeColor()===3){this.element.addCls(this.getCheckedCls3())}else{this.element.addCls(this.getCheckedCls())}}}this.thumbContainerElement.setStyle({"-webkit-transform":"translate3d("+this.thumbContainerElement.getWidth()+"px, 0, 0) ","-moz-transform":"translate3d("+this.thumbContainerElement.getWidth()+"px, 0, 0)"})}else{if(this.getCodeColor()===1){this.element.removeCls(this.getCheckedCls1())}else{if(this.getCodeColor()===2){this.element.removeCls(this.getCheckedCls2())}}if(this.getCodeColor()===3){this.element.removeCls(this.getCheckedCls3())}else{this.element.removeCls(this.getCheckedCls())}this.thumbContainerElement.setStyle({"-webkit-transform":"translate3d(0, 0, 0)","-moz-transform":"translate3d(0, 0, 0)"})}},onDragStart:function onDragStart(a,b){if(this.getDisabled()){return false}this.barX=this.barElement.getX();this.element.removeCls("transition")},onDrag:function onDrag(b,a){},onDragEnd:function onDragEnd(b,f){if(this.getDisabled()){return false}this.element.addCls("transition");var d=this.getValue(),c=Math.max(0,f.pageX-this.barX),g=this.barElement.getWidth()/2,a=d&&(c<g)||!d&&(c>g);if(a){this.doTap(false)}else{this.doTap(true)}}});Ext.define("Material.components.field.DatePicker",{extend:"Ext.field.DatePicker",requires:["Material.components.DatePicker"],xtype:"md-datepicker",updateValue:function(c,a){var b=this;if(c!==null){b.getComponent().setValue(Ext.Date.format(c,b.getDateFormat()||Ext.util.Format.defaultDateFormat));this.toggleValueIndicator(true)}else{b.getComponent().setValue("");this.toggleValueIndicator(false)}if(!Material.DatePickerService.isEqualDate(c,a)){b.fireEvent("change",b,c,a)}},getValue:function(){return this._value},onFocus:function(c){var b=this.getComponent(),a=this;this.fireEvent("focus",this,c);if(Ext.os.is.Android4){b.input.dom.focus()}b.input.dom.blur();if(this.getReadOnly()){return false}this.isFocused=true;this.element.addCls("x-field-focused");Material.DatePicker.setSelectedDate(a.getValue());Material.DatePicker.show({done:function(d){a.onDatePickerDone(d)},hide:function(){a.onDatePickerHide()}})},onDatePickerHide:function(){this.element.removeCls("x-field-focused")},onDatePickerDone:function(a){this.setValue(a)},destroy:function(){this.callSuper(arguments)}});Ext.define("Material.components.field.Text",{extend:"Ext.field.Text",requires:["Material.helpers.RippleService"],initialize:function(){this.callParent()},updatePlaceHolder:function(a){if(this.getLabelAlign()=="top"){if(a&&!/^\s+$/.test(a)){this.setLabel(a);this.renderElement.addCls("x-has-placeholder")}else{this.renderElement.removeCls("x-has-placeholder")}}else{this.callParent(arguments)}},updateReadOnly:function(a){this.callParent(arguments);this.element[a===true?"addCls":"removeCls"]("x-field-readonly")},updateValue:function(a){this.callParent(arguments);this.toggleValueIndicator(a)},doKeyUp:function(){this.callParent(arguments);this.toggleValueIndicator(this.getValue())},toggleValueIndicator:function(b){var a=b!==undefined&&b!==null&&b!=="";this.element[a?"addCls":"removeCls"]("x-field-has-value")}});(function(){Ext.define("Material.helpers.Constants",{})}());
/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a7,a6,a5,a4){function a1(e,d,f){return setTimeout(aT(e,f),d)}function a0(e,d,f){return Array.isArray(e)?(aZ(e,f[d],f),!0):!1}function aZ(f,d,h){var g;if(f){if(f.forEach){f.forEach(d,h)}else{if(f.length!==a4){for(g=0;g<f.length;){d.call(h,f[g],g,f),g++}}else{for(g in f){f.hasOwnProperty(g)&&d.call(h,f[g],g,f)}}}}}function aY(g,d,j){for(var i=Object.keys(d),h=0;h<i.length;){(!j||j&&g[i[h]]===a4)&&(g[i[h]]=d[i[h]]),h++}return g}function aX(d,c){return aY(d,c,!0)}function aU(g,f,j){var i,h=f.prototype;i=g.prototype=Object.create(h),i.constructor=g,i._super=h,j&&aY(i,j)}function aT(d,c){return function(){return d.apply(c,arguments)}}function aR(d,c){return typeof d==aj?d.apply(c?c[0]||a4:a4,c):d}function aQ(d,c){return d===a4?c:d}function aP(e,d,f){aZ(aJ(d),function(a){e.addEventListener(a,f,!1)})}function aN(e,d,f){aZ(aJ(d),function(a){e.removeEventListener(a,f,!1)})}function aM(d,c){for(;d;){if(d==c){return !0}d=d.parentNode}return !1}function aK(d,c){return d.indexOf(c)>-1}function aJ(b){return b.trim().split(/\s+/g)}function aI(f,e,h){if(f.indexOf&&!h){return f.indexOf(e)}for(var g=0;g<f.length;){if(h&&f[g][h]==e||!h&&f[g]===e){return g}g++}return -1}function aH(b){return Array.prototype.slice.call(b,0)}function aG(i,h,n){for(var m=[],l=[],k=0;k<i.length;){var j=h?i[k][h]:i[k];aI(l,j)<0&&m.push(i[k]),l[k]=j,k++}return n&&(m=h?m.sort(function(b,d){return b[h]>d[h]}):m.sort()),m}function aF(h,d){for(var l,k,j=d[0].toUpperCase()+d.slice(1),i=0;i<aV.length;){if(l=aV[i],k=l?l+j:d,k in h){return k}i++}return a4}function aE(){return a2++}function aD(d){var c=d.ownerDocument;return c.defaultView||c.parentWindow}function aC(e,d){var f=this;this.manager=e,this.callback=d,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(a){aR(e.options.enable,[e])&&f.handler(a)},this.init()}function aA(e){var d,f=e.options.inputClass;return new (d=f?f:ca?bs:bZ?bo:al?bl:bt)(e,bM)}function bM(i,h,n){var m=n.pointers.length,l=n.changedPointers.length,k=h&b1&&m-l===0,j=h&(b6|bU)&&m-l===0;n.isFirst=!!k,n.isFinal=!!j,k&&(i.session={}),n.eventType=h,bK(i,n),i.emit("hammer.input",n),i.recognize(n),i.session.prevInput=n}function bK(t,s){var r=t.session,q=s.pointers,p=q.length;r.firstInput||(r.firstInput=bG(s)),p>1&&!r.firstMultiple?r.firstMultiple=bG(s):1===p&&(r.firstMultiple=!1);var o=r.firstInput,n=r.firstMultiple,m=n?n.center:o.center,l=s.center=bD(q);s.timeStamp=bE(),s.deltaTime=s.timeStamp-o.timeStamp,s.angle=bz(m,l),s.distance=bA(m,l),bJ(r,s),s.offsetDirection=bB(s.deltaX,s.deltaY),s.scale=n?bv(n.pointers,q):1,s.rotation=n?bw(n.pointers,q):0,bI(r,s);var k=t.element;aM(s.srcEvent.target,k)&&(k=s.srcEvent.target),s.target=k}function bJ(h,g){var l=g.center,k=h.offsetDelta||{},j=h.prevDelta||{},i=h.prevInput||{};(g.eventType===b1||i.eventType===b6)&&(j=h.prevDelta={x:i.deltaX||0,y:i.deltaY||0},k=h.offsetDelta={x:l.x,y:l.y}),g.deltaX=j.x+(l.x-k.x),g.deltaY=j.y+(l.y-k.y)}function bI(v,u){var t,s,r,q,p=v.lastInterval||u,o=u.timeStamp-p.timeStamp;if(u.eventType!=bU&&(o>aa||p.velocity===a4)){var n=p.deltaX-u.deltaX,m=p.deltaY-u.deltaY,d=bC(o,n,m);s=d.x,r=d.y,t=bW(d.x)>bW(d.y)?d.x:d.y,q=bB(n,m),v.lastInterval=u}else{t=p.velocity,s=p.velocityX,r=p.velocityY,q=p.direction}u.velocity=t,u.velocityX=s,u.velocityY=r,u.direction=q}function bG(e){for(var d=[],f=0;f<e.pointers.length;){d[f]={clientX:b8(e.pointers[f].clientX),clientY:b8(e.pointers[f].clientY)},f++}return{timeStamp:bE(),pointers:d,center:bD(d),deltaX:e.deltaX,deltaY:e.deltaY}}function bD(g){var f=g.length;if(1===f){return{x:b8(g[0].clientX),y:b8(g[0].clientY)}}for(var j=0,i=0,h=0;f>h;){j+=g[h].clientX,i+=g[h].clientY,h++}return{x:b8(j/f),y:b8(i/f)}}function bC(e,d,f){return{x:d/e||0,y:f/e||0}}function bB(d,c){return d===c?by:bW(d)>=bW(c)?d>0?aW:av:c>0?ak:b9}function bA(g,f,j){j||(j=ax);var i=f[j[0]]-g[j[0]],h=f[j[1]]-g[j[1]];return Math.sqrt(i*i+h*h)}function bz(g,f,j){j||(j=ax);var i=f[j[0]]-g[j[0]],h=f[j[1]]-g[j[1]];return 180*Math.atan2(h,i)/Math.PI}function bw(d,c){return bz(c[1],c[0],am)-bz(d[1],d[0],am)}function bv(d,c){return bA(c[0],c[1],am)/bA(d[0],d[1],am)}function bt(){this.evEl=b0,this.evWin=bN,this.allow=!0,this.pressed=!1,aC.apply(this,arguments)}function bs(){this.evEl=ao,this.evWin=ad,aC.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function br(){this.evTarget=bP,this.evWin=bd,this.started=!1,aC.apply(this,arguments)}function bq(f,e){var h=aH(f.touches),g=aH(f.changedTouches);return e&(b6|bU)&&(h=aG(h.concat(g),"identifier",!0)),[h,g]}function bo(){this.evTarget=ap,this.targetIds={},aC.apply(this,arguments)}function bm(r,q){var p=aH(r.touches),o=this.targetIds;if(q&(b1|bO)&&1===p.length){return o[p[0].identifier]=!0,[p,p]}var n,m,l=aH(r.changedTouches),k=[],j=this.target;if(m=p.filter(function(b){return aM(b.target,j)}),q===b1){for(n=0;n<m.length;){o[m[n].identifier]=!0,n++}}for(n=0;n<l.length;){o[l[n].identifier]&&k.push(l[n]),q&(b6|bU)&&delete o[l[n].identifier],n++}return k.length?[aG(m.concat(k),"identifier",!0),k]:void 0}function bl(){aC.apply(this,arguments);var b=aT(this.handler,this);this.touch=new bo(this.manager,b),this.mouse=new bt(this.manager,b)}function bk(d,c){this.manager=d,this.set(c)}function bj(e){if(aK(e,bn)){return bn}var d=aK(e,aL),f=aK(e,aq);return d&&f?aL+" "+aq:d||f?d?aL:aq:aK(e,bQ)?bQ:af}function bi(b){this.id=aE(),this.manager=null,this.options=aX(b||{},this.defaults),this.options.enable=aQ(this.options.enable,!0),this.state=ag,this.simultaneous={},this.requireFail=[]}function bh(b){return b&at?"cancel":b&bu?"end":b&bS?"move":b&b4?"start":""}function bg(b){return b==b9?"down":b==ak?"up":b==aW?"left":b==av?"right":""}function bf(e,d){var f=d.manager;return f?f.get(e):e}function be(){bi.apply(this,arguments)}function bY(){be.apply(this,arguments),this.pX=null,this.pY=null}function ba(){be.apply(this,arguments)}function bR(){bi.apply(this,arguments),this._timer=null,this._input=null}function bp(){be.apply(this,arguments)}function aO(){be.apply(this,arguments)}function ar(){bi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ah(d,c){return c=c||{},c.recognizers=aQ(c.recognizers,ah.defaults.preset),new b5(d,c)}function b5(d,c){c=c||{},this.options=aX(c,ah.defaults),this.options.inputTarget=this.options.inputTarget||d,this.handlers={},this.session={},this.recognizers=[],this.element=d,this.input=aA(this),this.touchAction=new bk(this,this.options.touchAction),bT(this,!0),aZ(c.recognizers,function(f){var e=this.add(new f[0](f[1]));f[2]&&e.recognizeWith(f[2]),f[3]&&e.requireFailure(f[3])},this)}function bT(e,d){var f=e.element;aZ(e.options.cssProps,function(b,c){f.style[aF(f.style,c)]=d?b:""})}function bx(b,f){var e=a6.createEvent("Event");e.initEvent(b,!0,!0),e.gesture=f,f.target.dispatchEvent(e)}var aV=["","webkit","moz","MS","ms","o"],au=a6.createElement("div"),aj="function",b8=Math.round,bW=Math.abs,bE=Date.now,a2=1,aw=/mobile|tablet|ip(ad|hone|od)|android/i,al="ontouchstart" in a7,ca=aF(a7,"PointerEvent")!==a4,bZ=al&&aw.test(navigator.userAgent),bL="touch",a8="pen",ay="mouse",an="kinect",aa=25,b1=1,bO=2,b6=4,bU=8,by=1,aW=2,av=4,ak=8,b9=16,bX=aW|av,bF=ak|b9,a3=bX|bF,ax=["x","y"],am=["clientX","clientY"];aC.prototype={handler:function(){},init:function(){this.evEl&&aP(this.element,this.evEl,this.domHandler),this.evTarget&&aP(this.target,this.evTarget,this.domHandler),this.evWin&&aP(aD(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&aN(this.element,this.evEl,this.domHandler),this.evTarget&&aN(this.target,this.evTarget,this.domHandler),this.evWin&&aN(aD(this.element),this.evWin,this.domHandler)}};var cd={mousedown:b1,mousemove:bO,mouseup:b6},b0="mousedown",bN="mousemove mouseup";aU(bt,aC,{handler:function(d){var c=cd[d.type];c&b1&&0===d.button&&(this.pressed=!0),c&bO&&1!==d.which&&(c=b6),this.pressed&&this.allow&&(c&b6&&(this.pressed=!1),this.callback(this.manager,c,{pointers:[d],changedPointers:[d],pointerType:ay,srcEvent:d}))}});var a9={pointerdown:b1,pointermove:bO,pointerup:b6,pointercancel:bU,pointerout:bU},az={2:bL,3:a8,4:ay,5:an},ao="pointerdown",ad="pointermove pointerup pointercancel";a7.MSPointerEvent&&(ao="MSPointerDown",ad="MSPointerMove MSPointerUp MSPointerCancel"),aU(bs,aC,{handler:function(j){var i=this.store,p=!1,o=j.type.toLowerCase().replace("ms",""),n=a9[o],m=az[j.pointerType]||j.pointerType,l=m==bL,k=aI(i,j.pointerId,"pointerId");n&b1&&(0===j.button||l)?0>k&&(i.push(j),k=i.length-1):n&(b6|bU)&&(p=!0),0>k||(i[k]=j,this.callback(this.manager,n,{pointers:i,changedPointers:[j],pointerType:m,srcEvent:j}),p&&i.splice(k,1))}});var b2={touchstart:b1,touchmove:bO,touchend:b6,touchcancel:bU},bP="touchstart",bd="touchstart touchmove touchend touchcancel";aU(br,aC,{handler:function(e){var d=b2[e.type];if(d===b1&&(this.started=!0),this.started){var f=bq.call(this,e,d);d&(b6|bU)&&f[0].length-f[1].length===0&&(this.started=!1),this.callback(this.manager,d,{pointers:f[0],changedPointers:f[1],pointerType:bL,srcEvent:e})}}});var aB={touchstart:b1,touchmove:bO,touchend:b6,touchcancel:bU},ap="touchstart touchmove touchend touchcancel";aU(bo,aC,{handler:function(e){var d=aB[e.type],f=bm.call(this,e,d);f&&this.callback(this.manager,d,{pointers:f[0],changedPointers:f[1],pointerType:bL,srcEvent:e})}}),aU(bl,aC,{handler:function(g,f,j){var i=j.pointerType==bL,h=j.pointerType==ay;if(i){this.mouse.allow=!1}else{if(h&&!this.mouse.allow){return}}f&(b6|bU)&&(this.mouse.allow=!0),this.callback(g,f,j)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ae=aF(au.style,"touchAction"),b3=ae!==a4,bH="compute",af="auto",bQ="manipulation",bn="none",aL="pan-x",aq="pan-y";bk.prototype={set:function(b){b==bH&&(b=this.compute()),b3&&(this.manager.element.style[ae]=b),this.actions=b.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var b=[];return aZ(this.manager.recognizers,function(a){aR(a.options.enable,[a])&&(b=b.concat(a.getTouchAction()))}),bj(b.join(" "))},preventDefaults:function(i){if(!b3){var h=i.srcEvent,n=i.offsetDirection;if(this.manager.session.prevented){return void h.preventDefault()}var m=this.actions,l=aK(m,bn),k=aK(m,aq),j=aK(m,aL);return l||k&&n&bX||j&&n&bF?this.preventSrc(h):void 0}},preventSrc:function(b){this.manager.session.prevented=!0,b.preventDefault()}};var ag=1,b4=2,bS=4,bu=8,aS=bu,at=16,ai=32;bi.prototype={defaults:{},set:function(b){return aY(this.options,b),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(d){if(a0(d,"recognizeWith",this)){return this}var c=this.simultaneous;return d=bf(d,this),c[d.id]||(c[d.id]=d,d.recognizeWith(this)),this},dropRecognizeWith:function(b){return a0(b,"dropRecognizeWith",this)?this:(b=bf(b,this),delete this.simultaneous[b.id],this)},requireFailure:function(d){if(a0(d,"requireFailure",this)){return this}var c=this.requireFail;return d=bf(d,this),-1===aI(c,d)&&(c.push(d),d.requireFailure(this)),this},dropRequireFailure:function(d){if(a0(d,"dropRequireFailure",this)){return this}d=bf(d,this);var c=aI(this.requireFail,d);return c>-1&&this.requireFail.splice(c,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(b){return !!this.simultaneous[b.id]},emit:function(f){function e(a){h.manager.emit(h.options.event+(a?bh(g):""),f)}var h=this,g=this.state;bu>g&&e(!0),e(),g>=bu&&e(!0)},tryEmit:function(b){return this.canEmit()?this.emit(b):void (this.state=ai)},canEmit:function(){for(var b=0;b<this.requireFail.length;){if(!(this.requireFail[b].state&(ai|ag))){return !1}b++}return !0},recognize:function(d){var c=aY({},d);return aR(this.options.enable,[this,c])?(this.state&(aS|at|ai)&&(this.state=ag),this.state=this.process(c),void (this.state&(b4|bS|bu|at)&&this.tryEmit(c))):(this.reset(),void (this.state=ai))},process:function(){},getTouchAction:function(){},reset:function(){}},aU(be,bi,{defaults:{pointers:1},attrTest:function(d){var c=this.options.pointers;return 0===c||d.pointers.length===c},process:function(g){var f=this.state,j=g.eventType,i=f&(b4|bS),h=this.attrTest(g);return i&&(j&bU||!h)?f|at:i||h?j&b6?f|bu:f&b4?f|bS:b4:ai}}),aU(bY,be,{defaults:{event:"pan",threshold:10,pointers:1,direction:a3},getTouchAction:function(){var d=this.options.direction,c=[];return d&bX&&c.push(aq),d&bF&&c.push(aL),c},directionTest:function(i){var h=this.options,n=!0,m=i.distance,l=i.direction,k=i.deltaX,j=i.deltaY;return l&h.direction||(h.direction&bX?(l=0===k?by:0>k?aW:av,n=k!=this.pX,m=Math.abs(i.deltaX)):(l=0===j?by:0>j?ak:b9,n=j!=this.pY,m=Math.abs(i.deltaY))),i.direction=l,n&&m>h.threshold&&l&h.direction},attrTest:function(b){return be.prototype.attrTest.call(this,b)&&(this.state&b4||!(this.state&b4)&&this.directionTest(b))},emit:function(d){this.pX=d.deltaX,this.pY=d.deltaY;var c=bg(d.direction);c&&this.manager.emit(this.options.event+c,d),this._super.emit.call(this,d)}}),aU(ba,be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.scale-1)>this.options.threshold||this.state&b4)},emit:function(d){if(this._super.emit.call(this,d),1!==d.scale){var c=d.scale<1?"in":"out";this.manager.emit(this.options.event+c,d)}}}),aU(bR,bi,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[af]},process:function(g){var e=this.options,j=g.pointers.length===e.pointers,i=g.distance<e.threshold,h=g.deltaTime>e.time;if(this._input=g,!i||!j||g.eventType&(b6|bU)&&!h){this.reset()}else{if(g.eventType&b1){this.reset(),this._timer=a1(function(){this.state=aS,this.tryEmit()},e.time,this)}else{if(g.eventType&b6){return aS}}}return ai},reset:function(){clearTimeout(this._timer)},emit:function(b){this.state===aS&&(b&&b.eventType&b6?this.manager.emit(this.options.event+"up",b):(this._input.timeStamp=bE(),this.manager.emit(this.options.event,this._input)))}}),aU(bp,be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.rotation)>this.options.threshold||this.state&b4)}}),aU(aO,be,{defaults:{event:"swipe",threshold:10,velocity:0.65,direction:bX|bF,pointers:1},getTouchAction:function(){return bY.prototype.getTouchAction.call(this)},attrTest:function(e){var d,f=this.options.direction;return f&(bX|bF)?d=e.velocity:f&bX?d=e.velocityX:f&bF&&(d=e.velocityY),this._super.attrTest.call(this,e)&&f&e.direction&&e.distance>this.options.threshold&&bW(d)>this.options.velocity&&e.eventType&b6},emit:function(d){var c=bg(d.direction);c&&this.manager.emit(this.options.event+c,d),this.manager.emit(this.options.event,d)}}),aU(ar,bi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[bQ]},process:function(j){var e=this.options,p=j.pointers.length===e.pointers,o=j.distance<e.threshold,n=j.deltaTime<e.time;if(this.reset(),j.eventType&b1&&0===this.count){return this.failTimeout()}if(o&&n&&p){if(j.eventType!=b6){return this.failTimeout()}var m=this.pTime?j.timeStamp-this.pTime<e.interval:!0,l=!this.pCenter||bA(this.pCenter,j.center)<e.posThreshold;this.pTime=j.timeStamp,this.pCenter=j.center,l&&m?this.count+=1:this.count=1,this._input=j;var k=this.count%e.taps;if(0===k){return this.hasRequireFailures()?(this._timer=a1(function(){this.state=aS,this.tryEmit()},e.interval,this),b4):aS}}return ai},failTimeout:function(){return this._timer=a1(function(){this.state=ai},this.options.interval,this),ai},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==aS&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ah.VERSION="2.0.4",ah.defaults={domEvents:!1,touchAction:bH,enable:!0,inputTarget:null,inputClass:null,preset:[[bp,{enable:!1}],[ba,{enable:!1},["rotate"]],[aO,{direction:bX}],[bY,{direction:bX},["swipe"]],[ar],[ar,{event:"doubletap",taps:2},["tap"]],[bR]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var b7=1,bV=2;b5.prototype={set:function(b){return aY(this.options,b),b.touchAction&&this.touchAction.update(),b.inputTarget&&(this.input.destroy(),this.input.target=b.inputTarget,this.input.init()),this},stop:function(b){this.session.stopped=b?bV:b7},recognize:function(h){var g=this.session;if(!g.stopped){this.touchAction.preventDefaults(h);var l,k=this.recognizers,j=g.curRecognizer;(!j||j&&j.state&aS)&&(j=g.curRecognizer=null);for(var i=0;i<k.length;){l=k[i],g.stopped===bV||j&&l!=j&&!l.canRecognizeWith(j)?l.reset():l.recognize(h),!j&&l.state&(b4|bS|bu)&&(j=g.curRecognizer=l),i++}}},get:function(e){if(e instanceof bi){return e}for(var d=this.recognizers,f=0;f<d.length;f++){if(d[f].options.event==e){return d[f]}}return null},add:function(d){if(a0(d,"add",this)){return this}var c=this.get(d.options.event);return c&&this.remove(c),this.recognizers.push(d),d.manager=this,this.touchAction.update(),d},remove:function(d){if(a0(d,"remove",this)){return this}var c=this.recognizers;return d=this.get(d),c.splice(aI(c,d),1),this.touchAction.update(),this},on:function(e,d){var f=this.handlers;return aZ(aJ(e),function(b){f[b]=f[b]||[],f[b].push(d)}),this},off:function(e,d){var f=this.handlers;return aZ(aJ(e),function(b){d?f[b].splice(aI(f[b],d),1):delete f[b]}),this},emit:function(f,e){this.options.domEvents&&bx(f,e);var h=this.handlers[f]&&this.handlers[f].slice();if(h&&h.length){e.type=f,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var g=0;g<h.length;){h[g](e),g++}}},destroy:function(){this.element&&bT(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},aY(ah,{INPUT_START:b1,INPUT_MOVE:bO,INPUT_END:b6,INPUT_CANCEL:bU,STATE_POSSIBLE:ag,STATE_BEGAN:b4,STATE_CHANGED:bS,STATE_ENDED:bu,STATE_RECOGNIZED:aS,STATE_CANCELLED:at,STATE_FAILED:ai,DIRECTION_NONE:by,DIRECTION_LEFT:aW,DIRECTION_RIGHT:av,DIRECTION_UP:ak,DIRECTION_DOWN:b9,DIRECTION_HORIZONTAL:bX,DIRECTION_VERTICAL:bF,DIRECTION_ALL:a3,Manager:b5,Input:aC,TouchAction:bk,TouchInput:bo,MouseInput:bt,PointerEventInput:bs,TouchMouseInput:bl,SingleTouchInput:br,Recognizer:bi,AttrRecognizer:be,Tap:ar,Pan:bY,Swipe:aO,Pinch:ba,Rotate:bp,Press:bR,on:aP,off:aN,each:aZ,merge:aX,extend:aY,inherit:aU,bindFn:aT,prefixed:aF}),typeof define==aj&&define.amd?define(function(){return ah}):"undefined"!=typeof module&&module.exports?module.exports=ah:a7[a5]=ah}(window,document,"Hammer");Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.getShortMonthName=function(a){return Date.monthNames[a].substring(0,3)};Date.getShortDayName=function(a){return Date.dayNames[a].substring(0,3)};Date.getMonthNumber=function(a){return Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]};Date.parseCodes.S.s="(?:st|nd|rd|th)";if(Ext.picker.Picker){Ext.override(Ext.picker.Picker,{doneText:"Done"})}if(Ext.picker.Date){Ext.override(Ext.picker.Date,{dayText:"Day",monthText:"Month",yearText:"Year",slotOrder:["month","day","year"]})}if(Ext.IndexBar){Ext.override(Ext.IndexBar,{letters:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]})}if(Ext.NestedList){Ext.override(Ext.NestedList,{backText:"Back",loadingText:"Loading...",emptyText:"No items available."})}if(Ext.util.Format){Ext.util.Format.defaultDateFormat="m/d/Y"}if(Ext.MessageBox){Ext.MessageBox.OK.text="OK";Ext.MessageBox.CANCEL.text="Cancel";Ext.MessageBox.YES.text="Yes";Ext.MessageBox.NO.text="No"}Ext.data.SyncProxy=Ext.extend(Ext.data.Proxy,{definition:undefined,csv:undefined,generator:undefined,model:undefined,store:undefined,idProperty:undefined,idDefaultProperty:undefined,constructor:function(a,c,b){Ext.data.utilities.check("SyncProxy","constructor","config",a,["store","database_name","key"]);Ext.data.SyncProxy.superclass.constructor.call(this,a);this.store=a.store;this.store.readValue("Sencha.Sync.system_name",function(d){a.system_name=d||Ext.data.UUIDGenerator.generate();this.store.writeValue("Sencha.Sync.system_name",a.system_name,function(){Ext.data.utilities.apply(this,["readConfig_DatabaseDefinition","readConfig_CSV","readConfig_Generator"],[a],function(){if(this.definition.system_name===undefined){this.definition.set({system_name:Ext.data.UUIDGenerator.generate()})}console.log("SyncProxy - Opened database '"+a.key+"/"+a.database_name+"/"+a.datastore_name+"'");if(c){c.call(b,this)}},this)},this)},this)},create:function(b,d,c){b.records.forEach(function(e){e.setCreateState(this.makeGenerator());if(e.get(this.idProperty)===this.idPropertyDefaultValue){var f=e.getPair(Ext.data.SyncModel.OID);e.data[this.idProperty]=f.v}},this);var a=this.encodeRecords(b.records);return this.store.create(a,function(){this.indexCreatedRecords(a,function(){this.doCallback(d,c,b)},this)},this)},read:function(b,e,d){function c(g,f,h){f=this.decodeRecords(f);f=Ext.data.array.select(f,function(i){return i.isNotDestroyed()&&!i.phantom&&(!h||!i.isSystemModel())},this);g.resultSet=new Ext.data.ResultSet({records:f,total:f.length,loaded:true})}if(b.id!==undefined){this.store.indexLookup(b.id,function(f){this.store.read(f,function(g){c.call(this,b,[g],true);this.doCallback(e,d,b)},this)},this)}else{if(b[Ext.data.SyncModel.OID]!==undefined){this.store.read(b[Ext.data.SyncModel.OID],function(f){c.call(this,b,[f],false);this.doCallback(e,d,b)},this)}else{var a=[];this.store.forEachRecordAsync(function(g,f,h){a.push(g);f.call(h)},this,function(){c.call(this,b,a,true);this.doCallback(e,d,b)},this)}}},update:function(b,d,c){b.records.forEach(function(e){e.setUpdateState(this.makeGenerator())},this);var a=this.encodeRecords(b.records);return this.store.update(a,function(e){this.doCallback(d,c,e)},this)},destroy:function(b,d,c){var a=[];Ext.data.array.forEachAsync(b.records,function(f,e,h){f.setDestroyState(this.makeGenerator());var g=f.oid();if(!g){var i=f.data[this.idProperty];this.store.indexLookup(i,function(j){if(j){f.data[Ext.data.SyncModel.OID]=j;a.push(f)}e.call(h)},this)}else{a.push(f);e.call(h)}},this,function(){a=this.encodeRecords(a);this.store.update(a,function(e){e.action="destroy";this.indexDestroyedRecords(a,function(){this.doCallback(d,c,e)},this)},this)},this)},clear:function(b,a){this.store.clear(b,a)},setModel:function(b,d){this.model=b;this.idProperty=this.model.prototype.idProperty;var a=this.model.prototype.fields.items,e=a.length,f,c;for(c=0;c<e;c++){f=a[c];if(f.name===this.idProperty){this.idPropertyDefaultValue=f.defaultValue}}this.definition.set({idProperty:this.idProperty,idPropertyDefaultValue:this.idPropertyDefaultValue},function(){},this);Ext.apply(b.prototype,Ext.data.SyncModel);this.storageModel=b.prototype.createReplStorageModel(this.modelName);this.store.setModel(this.storageModel,d)},replicaNumber:function(){return this.generator.r},addReplicaNumbers:function(a,c,b){this.csv.addReplicaNumbers(a,c,b)},setReplicaNumber:function(c,d,b){if(!d){throw"ERROR - SyncProxy - setReplicaNumber - no callback provided."}var a=this.replicaNumber();console.log("SyncProxy.setReplicaNumber from",a,"to",c);this.changeReplicaNumber(a,c,function(){this.definition.setReplicaNumber(c,function(){this.csv.changeReplicaNumber(a,c,function(){this.generator.setReplicaNumber(c,d,b)},this)},this)},this)},changeReplicaNumber:function(a,c,d,b){console.log("SyncProxy.changeReplicaNumber from",a,"to",c);if(!d){throw"ERROR - SyncProxy - changeReplicaNumber - no callback provided."}this.forEachRecordAsync(function(g,e,i){if(!g.isSystemModel()){var f=g.oid();if(g.changeReplicaNumber(a,c)){var h=this.encodeRecords([g]);this.store.create(h,function(){this.indexCreatedRecords(h,function(){this.store.destroy(f,e,i)},this)},this)}else{e.call(i)}}else{e.call(i)}},this,d,b)},getUpdates:function(a,c,b){this.csv.addReplicaNumbers(a,function(){a.addReplicaNumbers(this.csv,function(){var d=[];this.forEachRecordAsync(function(f,e,g){d=d.concat(f.getUpdates(a));e.call(g)},this,function(){c.call(b,new Ext.data.Updates(d))},this)},this)},this)},putUpdates:function(b,d,a){var c=b.chunks(10);Ext.data.array.forEachYielding(c,function(f,e,g){Ext.data.array.forEachAsync(f.updates,function(j,i,h){this.applyUpdate(j,function(){this.generator.seen(j.c);this.csv.add(j.c,i,h)},this)},this,e,g)},this,d,a)},applyUpdate:function(d,c,a,b){if(b){console.log("ref ==> ",this.us(d))}else{console.log("applyUpdate",this.us(d))}this.store.read(d.i,function(e){if(e){var f=e.ref();if(f&&d.p[0]!="_"){if(d.i===f){console.log("Error - applyUpdate - Infinite loop following reference. ",f);c.call(a)}else{d.i=f;this.applyUpdate(d,c,a,f)}}else{if(d.p===this.idProperty){this.applyUpdateToRecordForUniqueID(e,d,c,a)}else{this.applyUpdateToRecord(e,d,c,a)}}}else{this.applyUpdateCreatingNewRecord(d,c,a)}},this)},applyUpdateCreatingNewRecord:function(d,c,b){if(d.p===Ext.data.SyncModel.OID){var a=this.createNewRecord(d.v,d.c);this.store.create([a],c,b)}else{console.log("Warning - Update received for unknown record "+d.i,d);var a=this.createNewRecord(d.i,d.i);a.setPair(d.p,d.v,d.c);this.store.create([a],c,b)}},applyUpdateToRecordForUniqueID:function(a,d,c,b){if(a.data[d.p]===d.v){this.applyUpdateToRecordForUniqueId(a,d,c,b)}else{this.store.indexLookup(d.v,function(e){if(e){this.readById(d.v,e,function(f){this.applyUpdateToRecordForUniqueId(a,d,function(){var i=new Ext.data.CS(a.oid());var j=new Ext.data.CS(f.oid());var g,h;if(i.greaterThan(j)){g=f;h=a}else{g=a;h=f}this.resolveUniqueIDConflict(g,h,function(){this.store.indexUpdate(d.v,g.oid(),c,b)},this)},this)},this)}else{this.applyUpdateToRecordForUniqueId(a,d,c,b)}},this)}},applyUpdatesToRecord:function(a,c,d,b){if(c.length>0){Ext.data.array.forEachAsync(c,function(g,e,f){this.applyUpdateToRecord(a,g,e,f)},this,d,b)}else{d.call(b)}},applyUpdateToRecordForUniqueId:function(a,f,e,c){var d=a.data[f.p];var b=f.v;this.applyUpdateToRecord(a,f,function(g){if(g){this.store.indexUpdate(b,a.oid(),function(){if(d){this.store.indexUpdate(d,undefined,function(){e.call(c,g)},this)}else{e.call(c,g)}},this)}else{e.call(c,g)}},this)},applyUpdateToRecord:function(a,d,c,b){if(a.putUpdate(d)){this.store.update([a],function(){c.call(b,true)},b)}else{c.call(b,false)}},readById:function(d,b,c,a){this.store.read(b,function(e){if(e){c.call(a,e)}else{console.log("ERROR - SyncProxy - applyUpdateToUniqueID - ID Index refers to an non-existant object:",d,"=>",b,"(This should not be possible.)")}},this)},resolveUniqueIDConflict:function(b,a,e,c){var d=this.updatesForMergeRecords(b,a);this.applyUpdatesToRecord(b,d,function(){var f=this.updatesForMakeReference(a,b);this.applyUpdatesToRecord(a,f,function(){e.call(c)},this)},this)},updatesForMergeRecords:function(d,b){var a=d.getCSV();var f=b.getUpdates(a);var e=[];var c=d.oid();f.forEach(function(g){if(g.p!==this.idProperty&&g.p!==Ext.data.SyncModel.OID){g.i=c;e.push(g)}},this);return e},updatesForMakeReference:function(b,a){if(b.oid()===a.oid()){console.log("updatesForMakeReference",b.data,a.data);throw"Error - SyncProxy - Tried to create reference to self."}var d=this.generateChangeStamp();var c=this.generateChangeStamp();var e=[{i:b.oid(),p:Ext.data.SyncModel.REF,v:a.oid(),c:d},{i:b.oid(),p:Ext.data.SyncModel.TOMBSTONE,v:c.to_s(),c:c}];return e},createNewRecord:function(c,b){var a=new this.storageModel();a.phantom=false;Ext.apply(a,Ext.data.SyncModel);a.setPair(Ext.data.SyncModel.OID,c,b);return a},indexCreatedRecords:function(a,c,b){Ext.data.array.forEachAsync(a,function(e,d,g){var f=e.data[this.idProperty];if(f){this.store.indexUpdate(f,e.data[Ext.data.SyncModel.OID],d,g)}else{d.call(g)}},this,c,b)},indexDestroyedRecords:function(a,c,b){Ext.data.array.forEachAsync(a,function(e,d,g){var f=e.data[this.idProperty];if(f){this.store.indexUpdate(f,undefined,d,g)}else{d.call(g)}},this,c,b)},makeGenerator:function(){var a=this;return function(){return a.generateChangeStamp()}},generateChangeStamp:function(){var a=this.generator.get();this.csv.add(a);return a},equals:function(a,c,b){if(this.csv.equals(a.csv)){this.hasSameRecords(a,function(d){if(d){a.hasSameRecords(this,c,b)}else{c.call(b,false)}},this)}else{c.call(b,false)}},hasSameRecords:function(a,c,b){this.forEachRecordAsync(function(e,d,f){this.store.read(e.oid(),function(g){if(g){var h=e.equals(g);if(h){d.call(f)}else{console.log("hasSameRecords - false - ",this.replicaNumber(),a.replicaNumber());c.call(b,false)}}else{console.log("hasSameRecords - false - ",this.replicaNumber(),a.replicaNumber());c.call(b,false)}},this)},this,function(){c.call(b,true)},this)},console_log:function(b,c,a){console.log("---- ",b);this.forEachRecordAsync(function(e,d,f){console.log(Ext.encode(e.data));d.call(f)},this,function(){console.log("----");c.call(a)},this)},forEachRecordAsync:function(e,c,a,b){var d=this.model;this.store.forEachRecordAsync(function(g,f,h){e.call(c,new d(g.data),f,h)},this,a,b)},encodeRecords:function(a){var b=this.storageModel;return Ext.data.array.collect(a,function(){var c=new b(this.data);c.internalId=this.internalId;c.phantom=false;return c})},decodeRecords:function(a){var b=this.model;return Ext.data.array.collect(a,function(){var c=new b(this.data);c.internalId=this.internalId;c.phantom=false;return c})},readConfig_DatabaseDefinition:function(b,e,d){var c={key:b.key,system_name:b.system_name,generation:0,replica_number:0};var a={database_name:b.database_name,replica_type:b.replica_type};this.readConfig(Ext.data.DatabaseDefinition,"definition",c,a,function(f){this.definition=f;e.call(d)},this)},readConfig_Generator:function(b,d,c){var a={r:this.definition.replica_number,clock:b.clock};this.readConfig(Ext.data.CSGenerator,"generator",{},a,function(e){this.generator=e;d.call(c)},this)},readConfig_CSV:function(a,c,b){this.readConfig(Ext.data.CSV,"csv",{},{},function(d){this.csv=d;c.call(b)},this)},writeConfig:function(d,a,c,b){this.store.writeConfig(d,a.as_data(),function(e){a.set(e);c.call(b)},this)},readConfig:function(e,h,c,a,g,d){var f,b;this.store.readConfig(h,function(j){if(c!==undefined){if(j===undefined){j=c}else{for(b in c){if(j[b]===undefined){j[b]=c[b];f=true}}}}if(a!==undefined){if(j===undefined){j=a}else{for(b in a){if(j[b]!==a[b]){j[b]=a[b];f=true}}}}var i=this;j.config_id=h;j.write_fn=function(k,l,m){i.writeConfig.call(i,h,k,l,m)};g.call(d,new e(j))},this)},doCallback:function(c,b,a){if(typeof c=="function"){c.call(b||this,a)}},us:function(b){var c=Ext.isArray(b.p)?b.p.join():b.p;var a=b.v;switch(typeof b.v){case"object":a=Ext.encode(b.v)}return"("+b.i+" . "+c+" = '"+a+"' @ "+b.c.to_s()+")"}});Ext.regModel("Sencha.Protocol.Model",{fields:[{name:"id"}]});Ext.data.SyncStorageProxy=Ext.extend(Ext.data.Proxy,{constructor:function(a){Ext.data.utilities.check("SyncStorageProxy","constructor","config",a,["id","url","key"]);Ext.data.SyncStorageProxy.superclass.constructor.call(this,a);a.database_name=a.id;a.datastore_name="data";a.localStorageProxy=a.localStorageProxy||Ext.data.ProxyMgr.create({type:"localstorage",id:a.database_name});a.store=a.store||new Ext.data.SyncStore(a);a.remoteStorageProxy=a.remoteStorageProxy||Ext.data.ProxyMgr.create({type:"scripttag",url:a.url,model:"Sencha.Protocol.Model"});this.proxy=new Ext.data.SyncProxy(a);Ext.data.utilities.delegate(this,this.proxy,["create","read","update","destroy","setModel"]);this.protocol=new Ext.data.Protocol(a)},sync:function(b,a){this.protocol.sync(this.proxy,b,a)}});Ext.data.ProxyMgr.registerType("syncstorage",Ext.data.SyncStorageProxy);Ext.data.SyncStore=Ext.extend(Object,{constructor:function(a){Ext.data.utilities.check("SyncStore","constructor","config",a,["database_name","localStorageProxy"]);this.local=a.localStorageProxy;this.readConfig("index",function(b){this.index=b||{}},this)},create:function(b,d,c){var a=new Ext.data.Operation({records:b});this.local.create(a,d,c)},read:function(c,d,b){var a=new Ext.data.Operation({action:"read",id:c});this.local.read(a,function(f){var e;if(f.resultSet.count==1){e=f.resultSet.records[0];Ext.apply(e,Ext.data.SyncModel)}else{}d.call(b,e)},this)},update:function(b,d,c){var a=new Ext.data.Operation({action:"update",records:b});this.local.update(a,d,c)},destroy:function(d,f,c){var e={};e[Ext.data.SyncModel.OID]=d;var b=[new this.local.model(e)];var a=new Ext.data.Operation({action:"destroy",records:b});this.local.destroy(a,f,c)},clear:function(b,a){this.local.clear();b.call(a)},setModel:function(a,b){this.model=a;this.local.setModel(a,b)},readConfig:function(c,e,a){var b=this.local.getStorageObject().getItem(this.local.id+"-"+c);var d=b?Ext.decode(b):{};e.call(a,d)},writeConfig:function(b,c,d,a){this.local.getStorageObject().setItem(this.local.id+"-"+b,Ext.encode(c));d.call(a,c)},indexUpdate:function(d,b,c,a){if(!c){throw"ERROR - SyncStore - indexUpdate - no callback provided"}console.log("SyncStore - indexUpdate -",d,"=>",b);this.index[d]=b;this.writeConfig("index",this.index,c,a)},indexLookup:function(d,c,a){if(!c){throw"ERROR - SyncStore - indexLookup - no callback provided"}var b=this.index[d];console.log("SyncStore - indexLookup -",d,"=>",b);c.call(a,b)},readValue:function(a,d,b){var c=this.local.getStorageObject().getItem(a);d.call(b,c)},writeValue:function(a,c,d,b){this.local.getStorageObject().setItem(a,c);d.call(b)},forEachRecordAsync:function(f,e,c,d){if(!f){throw"ERROR - SyncStore - forEachRecordAsync - no 'each' callback provided"}if(!c){throw"ERROR - SyncStore - forEachRecordAsync - no 'done' callback provided"}var a=new Ext.data.Operation({action:"read"});var b=this.local.getIds();Ext.data.array.forEachAsync(b,function(i,g,h){a.id=i;this.local.read(a,function(k){if(k.resultSet.count==1){var j=k.resultSet.records[0];f.call(e,j,g,h)}else{throw"ERROR - SyncStore - forEachRecordAsync - no record for id "+i;g.call(h)}},this)},this,c,d)}});Ext.data.array={select:function(b,d,c){var e=[];if(b){b.forEach(function(a){if(a!==undefined&&d.call(c||a,a)){e.push(a)}})}return e},index:function(c,g,f){if(c){var d,b=c.length;for(var e=0;e<b;e++){d=c[e];if(g.call(f||d,d)){return e}}}},collect:function(b,d,c){var e=[];if(b){b.forEach(function(a){if(a!==undefined){e.push(d.call(c||a,a))}})}return e},includes:function(c,d){if(c){var b=c.length;for(var e=0;e<b;e++){if(c[e]===d){return true}}}return false},remove:function(c,d){var g=[];if(c){var e,b=c.length;for(var f=0;f<b;f++){e=c[f];if(e!==d){g.push(e)}}}return g},any:function(c,g,f){var d,b=c.length;for(var e=0;e<b;e++){d=c[e];if(g.call(f||d,d)){return true}}return false},all:function(c,g,f){var d,b=c.length;for(var e=0;e<b;e++){var d=c[e];if(!g.call(f||d,d)){return false}}return true},forEachAsync:function(d,k,j,c,h){if(!k){throw"ERROR - Ext.data.Array - forEachAsync - no 'each' function provided"}if(!c){throw"ERROR - Ext.data.Array - forEachAsync - no 'done' function provided"}var e=0;var b=d.length;var g=function g(){if(e<b){var a=d[e];var f=j||a;e=e+1;k.call(f,a,g,f)}else{c.call(h)}};g()},forEachYielding:function(d,k,j,c,h){var e=0;var b=d.length;function g(){if(e<b){k.call(j,d[e],function(){e=e+1;setTimeout(g,20)},this)}else{c.call(h)}}g()}};Ext.data.CS=Ext.extend(Object,{r:0,t:0,s:0,constructor:function(a){this.set(a)},set:function(a){if(typeof a==="string"||a instanceof String){this.from_s(a)}else{if(typeof a==="object"){this.r=a.r||0;this.t=a.t||0;this.s=a.s||0}}},changeReplicaNumber:function(a,b){if(this.r==a){this.r=b;return true}return false},greaterThan:function(a){return this.compare(a)>0},lessThan:function(a){return this.compare(a)<0},equals:function(a){return this.compare(a)===0},compare:function(a){var b=this.t-a.t;if(b==0){b=this.s-a.s;if(b==0){b=this.r-a.r}}return b},from_s:function(b){var a=b.match(/(\d+)-(\d+)-?(\d+)?/);if(a&&a.length>0){this.r=parseInt(a[1]);this.t=parseInt(a[2]);this.s=a[3]?parseInt(a[3]):0}else{throw"Error - CS - Bad change stamp '"+b+"'."}return this},to_s:function(){return this.r+"-"+this.t+(this.s>0?"-"+this.s:"")}});Ext.data.CSGenerator=Ext.extend(Ext.data.Config,{r:undefined,t:undefined,s:undefined,clock:undefined,local_offset:undefined,global_offset:undefined,constructor:function(a,c,b){Ext.apply(this,a);a.config_id="generator";Ext.data.CSGenerator.superclass.constructor.call(this,a);this.clock=this.clock||new Ext.data.Clock();this.t=this.t||this.clock.now();this.s=this.s||-1;this.local_offset=this.local_offset||0;this.global_offset=this.global_offset||0;this.writeAndCallback(true,c,b)},get:function(c,a){var b=this.clock.now();this.update_local_offset(b);this.s+=1;if(this.s>255){this.t=b;this.local_offset+=1;this.s=0}this.writeAndCallback(true,c,a);return new Ext.data.CS({r:this.r,t:this.global_time(),s:this.s})},seen:function(b,e,a){var d=false;var c=this.clock.now();if(c>this.t){d=this.update_local_offset(c)}d=d||this.update_global_offset(b);this.writeAndCallback(d,e,a)},setReplicaNumber:function(c,d,a){var b=this.r!==c;this.r=c;this.writeAndCallback(b,d,a)},update_local_offset:function(d){var c=false;var e=d-this.t;if(e>0){var b=this.global_time();this.t=d;if(e>this.local_offset){this.local_offset=0}else{this.local_offset-=e}var a=this.global_time();if(a>b){this.s=-1}c=true}else{if(e<0){this.t=d;this.local_offset+=-e;c=true}}return c},update_global_offset:function(c){var f=false;var d=new Ext.data.CS({r:this.r,t:this.global_time(),s:this.s+1});var e=d.t;var h=d.s;var a=c.t;var b=c.s;if(a==e&&b>=h){this.s=b;f=true}else{if(a>e){var g=a-e;if(g>this.global_offset){this.global_offset+=g;this.s=b;f=true}}}return f},global_time:function(){return this.t+this.local_offset+this.global_offset},as_data:function(){var a={r:this.r,t:this.t,s:this.s,local_offset:this.local_offset,global_offset:this.global_offset};a[Ext.data.SyncModel.MODEL]="Ext.data.CSGenerator";return Ext.data.CSGenerator.superclass.as_data.call(this,a)}});Ext.data.CSV=Ext.extend(Ext.data.Config,{v:undefined,constructor:function(a,d,b){var c=false;if(a){a.config_id="csv";Ext.data.CSV.superclass.constructor.call(this,a);if(a.v){this.v=[];this.do_add(a.v)}}if(this.v===undefined){this.v=[];c=true}this.writeAndCallback(c,d,b)},add:function(a,d,b){var c=this.do_add(a);this.writeAndCallback(c,d,b);return this},get:function(a){return this.v[a.r]},setReplicaNumber:function(b,c,a){this.addReplicaNumbers([b],c,a)},addReplicaNumbers:function(a,e,c){var b=[];if(a instanceof Array){b=Ext.data.array.collect(a,function(f){return this.do_add(new Ext.data.CS({r:f}))},this)}else{if(a instanceof Ext.data.CSV){b=Ext.data.array.collect(a.v,function(f){return this.do_add(new Ext.data.CS({r:f.r}))},this)}}var d=Ext.data.array.includes(b,true);this.writeAndCallback(d,e,c)},do_add:function(a){var d=false;if(a instanceof Ext.data.CSV){var b=Ext.data.array.collect(a.v,this.do_add,this);d=Ext.data.array.includes(b,true)}else{if(a instanceof Ext.data.CS){var c=a.r;var b=this.v[c];if(!b||a.greaterThan(b)){this.v[c]=new Ext.data.CS({r:a.r,t:a.t,s:a.s});d=true}}else{if(typeof a=="string"||a instanceof String){d=this.do_add(new Ext.data.CS(a))}else{if(a instanceof Array){var b=Ext.data.array.collect(a,this.do_add,this);d=Ext.data.array.includes(b,true)}else{throw"Error - CSV - do_add - Unknown type: "+(typeof a)+": "+a}}}}return d},changeReplicaNumber:function(a,d,f,c){var b=this.v[a];var e=false;if(b){b.r=d;this.v[a]=undefined;this.v[d]=b;e=true}this.writeAndCallback(e,function(){f.call(c,this,e)},this)},isEmpty:function(){return this.v.length<1},maxChangeStamp:function(){if(!this.isEmpty()){var a=new Ext.data.CS();this.v.forEach(function(c){var b=new Ext.data.CS({t:c.t,s:c.s});a=(b.greaterThan(a)?c:a)},this);return a}},dominates:function(a){return Ext.data.array.any(this.compare(a),function(b){return b>0})},equals:function(a){return Ext.data.array.all(this.compare(a),function(b){return b===0})},compare:function(a){var c,d,e;if(a instanceof Ext.data.CS){d=this.get(a);return[d?d.compare(a):-1]}else{if(a instanceof Ext.data.CSV){e=[];for(c in this.v){d=this.v[c];if(d instanceof Ext.data.CS){var b=a.get(d);e.push(b?d.compare(b):1)}}return e}else{throw"Error - CSV - compare - Unknown type: "+(typeof a)+": "+a}}return[-1]},forEach:function(b,a){this.v.forEach(b,a||this)},encode:function(){return Ext.data.array.collect(this.v,function(){return this.to_s()})},decode:function(a){this.do_add(a);return this},to_s:function(a){var b="CSV: ";this.v.forEach(function(c){b+=c.to_s()+", "},this);return b},as_data:function(){var a={v:Ext.data.array.collect(this.v,function(){return this.to_s()})};a[Ext.data.SyncModel.MODEL]="Ext.data.CSV";return Ext.data.CSV.superclass.as_data.call(this,a)}});Ext.data.Clock=Ext.extend(Object,{constructor:function(){this.epoch=new Date(2011,0,1)},now:function(){return this.ms_to_s(new Date().getTime()-this.epoch)},ms_to_s:function(a){return Math.floor(a/1000)}});Ext.data.Config=Ext.extend(Object,{config_id:undefined,write_fn:undefined,_id:undefined,constructor:function(a){this.config_id=a.config_id;this.write_fn=a.write_fn;this._id=a._id},set:function(a){this._id=a._id},to_s:function(a){return this.config_id+": "+Ext.encode(this)},as_data:function(a){a.id=this.config_id;a._id=this._id;a[Ext.data.SyncModel.OID]=a[Ext.data.SyncModel.OID]||this.config_id;return a},writeAndCallback:function(b,c,a){if(b){this.write(function(){if(c){c.call(a,this)}},this)}else{if(c){c.call(a,this)}}},write:function(b,a){if(this.write_fn){this.write_fn(this,function(){if(b){b.call(a,this)}},this)}else{if(b){b.call(a,this)}}}});Ext.data.DatabaseDefinition=Ext.extend(Ext.data.Config,{key:undefined,database_name:undefined,generation:undefined,system_name:undefined,system_names:{},replica_number:undefined,idProperty:undefined,idPropertyDefaultValue:undefined,version:1,constructor:function(a,c,b){Ext.data.utilities.check("DatabaseDefinition","constructor","config",a,["key","database_name","generation","system_name","replica_number"]);this.set(a);a.config_id="definition";Ext.data.DatabaseDefinition.superclass.constructor.call(this,a)},setReplicaNumber:function(c,d,a){var b=(this.replica_number!=c);this.replica_number=c;this.writeAndCallback(b,d,a)},addSystemName:function(a){this.system_names[a]=true},isKnownOf:function(a){return this.system_name===a||Ext.data.array.includes(this.system_names,a)},set:function(a,d,b){var c=Ext.data.utilities.copy(a,this,["key","database_name","generation","system_name","system_names","replica_number","idProperty","idPropertyDefaultValue","version","_id"]);this.writeAndCallback(c,d,b)},as_data:function(){var a={key:this.key,database_name:this.database_name,generation:this.generation,system_name:this.system_name,system_names:this.system_names,replica_number:this.replica_number,idProperty:this.idProperty,idPropertyDefaultValue:this.idPropertyDefaultValue,version:this.version};a[Ext.data.SyncModel.MODEL]="Ext.data.DatabaseDefinition";return Ext.data.DatabaseDefinition.superclass.as_data.call(this,a)},encode:function(){return{key:this.key,database_name:this.database_name,generation:this.generation,system_name:this.system_name,replica_number:this.replica_number,idProperty:this.idProperty,idPropertyDefaultValue:this.idPropertyDefaultValue}}});Ext.data.Protocol=Ext.extend(Object,{constructor:function(a){this.remote=a.remoteStorageProxy;this.remote.on("exception",function(c,d,b){console.log("EXCEPTION");console.log(d);console.log(b)})},sync:function(a,c,b){if(c===undefined){c=function(){}}this.send_create_database(a.definition,function(e){var d=e.response;switch(d.r){case"ok":var f=d.csv;a.addReplicaNumbers(f);this.sync_datastore(a,f,c,b);break;case"new_replica_number":a.setReplicaNumber(d.replica_number,function(){this.sync(a,c,b)},this);break;case"new_generation_number":if(d.generation>a.definition.generation){a.definition.set({generation:d.generation},function(){a.clear(function(){this.sync(a,c,b)},this)},this)}else{}break;default:c.call(b);break}},this)},sync_datastore:function(a,d,c,b){a.getUpdates(d,function(e){this.put_database_updates(a.definition,e,function(f){if(d.dominates(a.csv)){this.get_database_updates(a,c,b)}else{c.call(b)}},this)},this)},send_create_database:function(a,d,b){var c=a.encode();this.sendRequest(a.database_name,"edit",c,function(f){var e=f.response;if(e.csv){e.csv=new Ext.data.CSV().decode(e.csv)}d.call(b,f)},this)},put_database_updates:function(a,c,e,b){var d=c.chunks(1000);Ext.data.array.forEachYielding(d,function(g,f,h){this.send_put_database_updates(a,g,function(i){f.call(h)},this)},this,e,b)},send_put_database_updates:function(b,e,f,c){if(!e.isEmpty()){var d={updates:Ext.encode(e.encode())};this.sendRequest(b.database_name,"put_updates",d,f,c)}else{var a=this.encodeRequest({});a.response={r:"ok"};f.call(c,a)}},get_database_updates:function(a,c,b){this.send_get_database_updates(a.definition,a.csv,function(e){var d=e.response;if(d.r=="ok"){a.putUpdates(d.updates,function(){if(d.remaining>0&&!d.updates.isEmpty()){this.get_database_updates(a,c,b)}else{c.call(b)}},this)}else{c.call(b)}},this)},send_get_database_updates:function(b,a,e,c){var d={csv:a.encode()};this.sendRequest(b.database_name,"get_updates",d,function(g){var f=g.response;f.updates=new Ext.data.Updates().decode(f.updates);e.call(c,g)},this)},sendRequest:function(a,g,e,f,d){var c=this.encodeRequest(a,g,e);var b=true;if(b){console.log("local ->",this.remote.url,g,Ext.encode(e))}this.remote.read(c,function(h){if(b){console.log("  sent",h.request.url.length,"bytes -",h.request.url);console.log("  <= ",g,Ext.encode(h.response))}f.call(d,h)},this)},encodeRequest:function(a,e,c){var d=Ext.encode(c);var b=this.remote.url+"database/"+a+"/"+e;return new Ext.data.Operation({filters:[],action:"read",url:b,params:c});return operation}});Ext.data.SyncModel={STATE:"_state",TOMBSTONE:"_ts",OID:"_oid",REF:"_ref",MODEL:"_model",state:undefined,createReplStorageModel:function(a){var c=this.fields.items.slice(0);c=c.concat([{name:"_state"},{name:"_ts"},{name:"_oid"},{name:"_ref"},{name:"_model"}]);var b=Ext.regModel("Sencha.StorageModel."+a,{fields:c,idProperty:Ext.data.SyncModel.OID});return b},oid:function(){return this.data[Ext.data.SyncModel.OID]},ref:function(){return this.data[Ext.data.SyncModel.REF]},userData:function(){var b={};for(var a in this.data){if(a[0]!=="_"){b[a]=this.data[a]}}return b},isSystemModel:function(){var a=this.data[Ext.data.SyncModel.MODEL];return a!==undefined&&a.indexOf("Ext.data.",0)===0},changeReplicaNumber:function(a,c){this.setup();var d=false;this.forEachCS(this.state,function(g){var f=g.changeReplicaNumber(a,c);d=d||f;return g},this);var b=this.oid();if(b){var e=new Ext.data.CS(b);if(e.changeReplicaNumber(a,c)){this.data[Ext.data.SyncModel.OID]=e.to_s();d=true}}return d},setCreateState:function(b){this.state={};var a=b();this.setPair(Ext.data.SyncModel.OID,a.to_s(),a);this.forEachValue(this.data,[],function(d,c){if(d[0]!==Ext.data.SyncModel.OID){this.setCS(d,b())}},this)},setUpdateState:function(c){var b=this.getChanges(),a;for(a in b){if(a!==Ext.data.SyncModel.STATE&&a!==Ext.data.SyncModel.OID){this.setUpdateStateValue([a],this.modified[a],b[a],c)}}},setUpdateStateValue:function(g,b,f,e){if(this.isComplexValueType(f)){if(b){var c={};if(this.isComplexValueType(b)){if(this.valueType(b)===this.valueType(f)){c=Ext.data.utilities.minus(f,b);var h=Ext.data.utilities.intersection(f,b);for(var d in h){if(h.hasOwnProperty(d)){if(b[d]!==f[d]){c[d]=f[d]}}}}else{c=f;this.setCS(g,e())}}else{c=f;this.setCS(g,e())}}else{c=f;this.setCS(g,e())}for(var d in c){if(c.hasOwnProperty(d)){var a=b?b[d]:undefined;this.setUpdateStateValue(g.concat(d),a,f[d],e)}}}else{this.setCS(g,e())}},setDestroyState:function(b){var a=b();this.data[Ext.data.SyncModel.TOMBSTONE]=a.to_s();this.setCS(Ext.data.SyncModel.TOMBSTONE,a)},isNotDestroyed:function(){var a=this.data[Ext.data.SyncModel.TOMBSTONE];return(a===undefined||a==="")},getUpdates:function(a){this.setup();var c=[];var b=this.oid();this.forEachPair(this.data,this.state,[],[],function(g,d,f){if(f){var e=a.get(f);if(!e||e.lessThan(f)){c.push({i:b,p:g.length==1?g[0]:g,v:d.length==1?d[0]:d,c:f})}}},this);return c},putUpdate:function(a){return this.setPair(a.p,a.v,a.c)},equals:function(a){this.forEachPair(this.data,this.state,[],[],function(f,b,c){var e=a.getPair(f);var d=b[b.length-1];if(!(c.equals(a.c)&&d===a.v)){return false}},this);return true},forEachPair:function(e,a,m,h,j,k){this.setup();for(var b in a){if(a.hasOwnProperty(b)){var c=a[b];var f=e[b];var d=m.concat(b);var i=this.valueType(f);var g;switch(i){case"object":g={};break;case"array":g=[[]];break;default:g=f}var l=h.concat(g);switch(this.valueType(c)){case"string":j.call(k,d,l,new Ext.data.CS(c));break;case"array":switch(i){case"undefined":console.log("Warning - There was no data for the state at path",d);console.log("Warning -",Ext.encode(this.data));break;case"object":case"array":j.call(k,d,l,new Ext.data.CS(c[0]));this.forEachPair(f,c[1],d,l,j,k);break;default:j.call(k,d,l,new Ext.data.CS(c[0]));break}break}}}},forEachValue:function(c,e,g,b){var f,a;for(f in c){if(c.hasOwnProperty(f)){a=c[f];if(a!==this.state){var d=e.concat(f);g.call(b,d,a);if(this.isComplexValueType(a)){this.forEachValue(a,d,g,b)}}}}},getCSV:function(){var a=new Ext.data.CSV();this.forEachCS(this.state,function(b){a.add(b)},this);return a},forEachCS:function(d,f,c){var a,e,b;for(a in d){if(d.hasOwnProperty(a)){e=d[a];switch(this.valueType(e)){case"string":b=f.call(c,new Ext.data.CS(e));if(b){d[a]=b.to_s()}break;case"array":b=f.call(c,new Ext.data.CS(e[0]));if(b){d[a][0]=b.to_s()}this.forEachCS(e[1],f,c);break}}}},getCS:function(g){this.setup();var d=this.state;if(Ext.isArray(g)){var a=g.length;var f=a-1;for(var c=0;c<a;c++){var b=g[c];if(c===f){return this.do_getCS(d,b)}else{d=this.do_getState(d,b)}}}else{return this.do_getCS(d,g)}},do_getCS:function(c,a){var b=undefined;c=c[a];if(c){switch(this.valueType(c)){case"string":b=new Ext.data.CS(c);break;case"array":b=new Ext.data.CS(c[0]);break;default:console.log("Error - SyncModel - do_getCS - unexpected type in state for",a,":",typeof c,c);console.log("state",Ext.encode(this.data));b=new Ext.data.CS();break}}return b},setCS:function(h,d){this.setup();var f=this.state;if(Ext.isArray(h)){var a=h.length;var g=a-1;for(var c=0;c<a;c++){var b=h[c];if(c===g){this.do_setCS(f,b,d)}else{f=this.do_getState(f,b)}}}else{this.do_setCS(f,h,d)}},do_setCS:function(d,b,c){var e=(c instanceof Ext.data.CS)?c.to_s():c;var a=d[b];if(a){switch(this.valueType(a)){case"string":d[b]=e;break;case"array":a[0]=e;break;default:console.log("Error - SyncModel - do_setCS - unexpected type in state for",b,":",typeof a,a);console.log("state",Ext.encode(d));console.log("name",b,"cs",e);d[b]=e}}else{d[b]=e}},getPair:function(h){this.setup();var f=this.data;var d=this.state;if(Ext.isArray(h)){var a=h.length;var g=a-1;for(var c=0;c<a;c++){var b=h[c];if(c===g){return{v:f?f[b]:f,c:this.do_getCS(d,b)}}else{d=this.do_getState(d,b);f=f?f[b]:f}}}else{return{v:f[h],c:this.do_getCS(d,h)}}},setPair:function(s,r,d){var k=false;this.setup();if(!Ext.isArray(s)){s=[s];r=[r]}var m=this.data;var c=this.state;var f=s.length;var n=f-1;for(var j=0;j<f;j++){var b=s[j];var q=r[j];var p=this.do_getCS(c,b);var o=m[b];var h=this.valueType(o);var g=this.valueType(q);var a=((h==="object"&&g==="object")||(h==="array"&&g==="array"));if(p){if(d.greaterThan(p)){if(a){q=undefined}if(this.do_setPair(m,c,b,q,d)){k=true}}else{if(a){}else{return k}}}else{if(this.do_setPair(m,c,b,q,d)){k=true}}if(j!==n){m=this.do_getData(m,b);c=this.do_getState(c,b,d)}}return k},do_getState:function(d,a,c){var e=d[a];switch(this.valueType(e)){case"undefined":var b={};d[a]=[c,b];d=b;break;case"string":var b={};d[a]=[e,b];d=b;break;case"array":d=e[1];break;default:throw"Error - SyncModel - do_getState - unexpected type in state: "+(typeof e)+" "+e}return d},do_setPair:function(d,c,a,b,e){var f=false;if(b!==undefined){this.do_setData(d,a,b);f=true}if(e!==undefined){this.do_setCS(c,a,e);f=true}return f},do_getData:function(b,a){return b[a]},do_setData:function(c,a,b){c[a]=b},valueType:function(b){var a=typeof b;if(a==="object"&&(b instanceof Array)){a="array"}return a},valueEquals:function(e,d){var c=false;var b=this.valueType(e);var a=this.valueType(d);if(b===a){switch(b){case"object":case"array":c=Ext.encode(e)===Ext.encode(d);break;default:c=e===d}}return c},isComplexValueType:function(a){return(typeof a==="object")},setup:function(){this.data[Ext.data.SyncModel.STATE]=this.data[Ext.data.SyncModel.STATE]||{};this.state=this.data[Ext.data.SyncModel.STATE]}};Ext.data.UUIDGenerator={generate:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})}};Ext.data.Updates=Ext.extend(Object,{updates:undefined,constructor:function(a){this.updates=a||[];this.updates.forEach(function(b){if(!(b.c instanceof Ext.data.CS)){b.c=new Ext.data.CS(b.c)}});this.updates.sort(function(d,c){return d.c.compare(c.c)})},push:function(b){var a=this.updates[this.updates.length];if(b.c.lessThan(a)){throw"Error - Updates - Tried to push updates in wrong order. "+a+" "+b}this.updates.push(b)},isEmpty:function(){return this.updates.length<1},forEach:function(b,a){this.updates.forEach(b,a)},forEachAsync:function(d,c,a,b){Ext.data.array.forEachAsync(this.updates,d,c,a,b)},limit:function(b){var a=Math.max(0,this.updates.length-b);if(a>0){this.updates=this.updates.slice(0,b)}return a},chunks:function(f){var e=[];var b=this.updates.length;var h=(b/f)+1;for(var d=0;d<h;d++){var g=d*f;var a=g+f;var c=new Ext.data.Updates();c.updates=this.updates.slice(g,a);e.push(c)}return e},decode:function(j){this.updates=[];if(j){var e=j.length;var f,d,a,b,k,h;for(var g=0;g<e;g++){f=j[g];switch(f.length){case 3:a=d;b=f[0];k=f[1];h=f[2];break;case 4:a=f[0];b=f[1];k=f[2];h=f[3];d=a;break}h=((h instanceof Ext.data.CS)?h:new Ext.data.CS(h));this.updates.push({i:a,p:b,v:k,c:h})}}return this},encode:function(){var e=[];var a=this.updates.length;var c,f,d;for(var b=0;b<a;b++){f=this.updates[b];d=((f.c instanceof Ext.data.CS)?f.c.to_s():f.c);if(f.i===c){e.push([f.p,f.v,d])}else{e.push([f.i,f.p,f.v,d]);c=f.i}}return e}});Ext.data.utilities={delegate:function(c,b,a){if(b===undefined){throw"Error - Tried to delegate '"+a+"' to undefined instance."}a.forEach(function(e){var d=b[e];if(d===undefined){throw"Error - Tried to delegate undefined method '"+e+"' to "+b}c[e]=function(){return d.apply(b,arguments)}})},apply:function(b,d,c,e,f){var g=true;Ext.data.array.forEachAsync(d,function(i,a,h){if(g){c.push(a);c.push(h);g=false}b[i].apply(b,c)},b,e,f)},copy:function(d,b,a){var c=false;a.forEach(function(g){var f=d[g];var e=b[g];if(f!==undefined&&f!==e){b[g]=f;c=true}});return c},copyIfUndefined:function(d,b,a){var c=false;a.forEach(function(g){var f=d[g];var e=b[g];if(f!==undefined&&e===undefined){b[g]=f;c=true}});return c},check:function(f,c,e,a,b){if(a===undefined){var d="Error - "+f+"."+c+" - "+e+" not provided.";console.log(d);throw d}else{b.forEach(function(i){var h=a[i];if(h===undefined){var g="Error - "+f+"."+c+" - "+e+"."+i+" not provided.";console.log(g);throw g}})}},minus:function(d,c){var f,e={};for(f in d){if(d.hasOwnProperty(f)){if(c[f]===undefined){e[f]=d[f]}}}return e},intersection:function(d,c){var f,e={};for(f in d){if(d.hasOwnProperty(f)){if(c[f]!==undefined){e[f]=d[f]}}}return e}};